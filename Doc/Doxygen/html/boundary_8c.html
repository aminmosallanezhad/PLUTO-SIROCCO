<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PLUTO: /Users/mignone/PLUTO/Src/boundary.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PLUTO<span id="projectnumber">&#160;4.4-patch3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_413f4e031a85da0d68269c6fd2f76e1c.html">Src</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">boundary.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Set boundary conditions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="pluto_8h_source.html">pluto.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa4ac8e2a2c5749634c201e8c8701d248" id="r_aa4ac8e2a2c5749634c201e8c8701d248"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa4ac8e2a2c5749634c201e8c8701d248">FlipSign</a> (int, int, int *)</td></tr>
<tr class="separator:aa4ac8e2a2c5749634c201e8c8701d248"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72d27e046c2179f09183135389d69ca4" id="r_a72d27e046c2179f09183135389d69ca4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a72d27e046c2179f09183135389d69ca4">Boundary</a> (const <a class="el" href="struct_data.html">Data</a> *d, int iarr, <a class="el" href="struct_grid.html">Grid</a> *grid)</td></tr>
<tr class="separator:a72d27e046c2179f09183135389d69ca4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40d460347652e7d9f5495ea10d2bae65" id="r_a40d460347652e7d9f5495ea10d2bae65"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a40d460347652e7d9f5495ea10d2bae65">OutflowBoundary</a> (double ***<a class="el" href="runtime__setup_8c.html#a3e58e35a6ccdfe7fa814a3d1e39f7d5b">q</a>, <a class="el" href="struct_r_box.html">RBox</a> *box, int side)</td></tr>
<tr class="separator:a40d460347652e7d9f5495ea10d2bae65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6280cd6ff9db6d2e28fc8503ae7fdea8" id="r_a6280cd6ff9db6d2e28fc8503ae7fdea8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6280cd6ff9db6d2e28fc8503ae7fdea8">PeriodicBoundary</a> (double ***<a class="el" href="runtime__setup_8c.html#a3e58e35a6ccdfe7fa814a3d1e39f7d5b">q</a>, <a class="el" href="struct_r_box.html">RBox</a> *box, int side)</td></tr>
<tr class="separator:a6280cd6ff9db6d2e28fc8503ae7fdea8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1f86b18467f2d476956cb0e773d5c2a" id="r_af1f86b18467f2d476956cb0e773d5c2a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af1f86b18467f2d476956cb0e773d5c2a">ReflectiveBoundary</a> (double ***<a class="el" href="runtime__setup_8c.html#a3e58e35a6ccdfe7fa814a3d1e39f7d5b">q</a>, int <a class="el" href="fargo_8c.html#ac9562ee4ecb3b8aeebeb04656e7e57a9">s</a>, int stag, <a class="el" href="struct_r_box.html">RBox</a> *box, int side)</td></tr>
<tr class="separator:af1f86b18467f2d476956cb0e773d5c2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80dffcc90bfaed8ac6a9a095cffb1a1f" id="r_a80dffcc90bfaed8ac6a9a095cffb1a1f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a80dffcc90bfaed8ac6a9a095cffb1a1f">PolarAxisBoundary</a> (const <a class="el" href="struct_data.html">Data</a> *d, <a class="el" href="struct_r_box.html">RBox</a> *box, int side)</td></tr>
<tr class="separator:a80dffcc90bfaed8ac6a9a095cffb1a1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><br  />
 </p>
<p>The <a class="el" href="#a72d27e046c2179f09183135389d69ca4">Boundary()</a> function sets both internal and physical boundary conditions on one or more sides of the computational domain. It is used to fill ghost zones of both cell-centered and face-centered data arrays.<br  />
The type of boundary conditions at the leftmost or rightmost side of a given grid is specified by the integers <code> grid.lbound[dir] </code> or <code> grid.rbound[dir] </code>, respectively. When this value is different from zero, the local processor borders the physical boundary and the admissible values for <code>lbound</code> or <code>rbound</code> are OUTFLOW, REFLECTIVE, AXISYMMETRIC, EQTSYMMETRIC, PERIODIC, SHEARING or USERDEF. Conversely, when this value is zero (internal boundary), two neighboring processors that share the same side need to fill ghost zones by exchanging data values. This step is done here only for parallel computations on static grids.</p>
<p>Predefined physical boundary conditions are handled by the following functions:</p>
<ul>
<li><a class="el" href="#a40d460347652e7d9f5495ea10d2bae65">OutflowBoundary()</a></li>
<li><a class="el" href="#af1f86b18467f2d476956cb0e773d5c2a">ReflectiveBoundary()</a></li>
<li><a class="el" href="#a6280cd6ff9db6d2e28fc8503ae7fdea8">PeriodicBoundary()</a></li>
</ul>
<dl class="section note"><dt>Note</dt><dd>For staggered mesh+periodic b.c, the leftmost value of <em>each</em> processor is overwritten with a value NX1 zones to the right:</dd></dl>
<p>--&gt;Before:</p>
<p>proc #0 proc #1 proc #2 proc #3 |.......| |.......| |.......| |.......| A B C D E F G H</p>
<p>--&gt; <a class="el" href="#a6280cd6ff9db6d2e28fc8503ae7fdea8">PeriodicBoundary()</a> --&gt; After:</p>
<p>proc #0 proc #1 proc #2 proc #3 |.......| |.......| |.......| |.......| H B B D D F F H</p>
<dl class="section author"><dt>Author</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'and'+'re'+'a.m'+'ig'+'non'+'e@'+'uni'+'to'+'.it'; return false;">andre<span class="obfuscator">.nosp@m.</span>a.mi<span class="obfuscator">.nosp@m.</span>gnone<span class="obfuscator">.nosp@m.</span>@uni<span class="obfuscator">.nosp@m.</span>to.it</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Apr 08, 2024 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a72d27e046c2179f09183135389d69ca4" name="a72d27e046c2179f09183135389d69ca4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72d27e046c2179f09183135389d69ca4">&#9670;&#160;</a></span>Boundary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Boundary </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_data.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>iarr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *</td>          <td class="paramname"><span class="paramname"><em>grid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set boundary conditions on one or more sides of the computational domain.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d</td><td>pointer to PLUTO <a class="el" href="struct_data.html">Data</a> structure containing the solution array (including centered and staggered fields) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iarr</td><td>specifies on which array b.c. have to be set<ul>
<li>iarr = 0 (set on d-&gt;Vc a nd d-&gt;Vs)</li>
<li>iarr = 1 (set on d-&gt;Vpc and d-&gt;Vps)</li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>pointer to grid structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa4ac8e2a2c5749634c201e8c8701d248" name="aa4ac8e2a2c5749634c201e8c8701d248"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4ac8e2a2c5749634c201e8c8701d248">&#9670;&#160;</a></span>FlipSign()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void FlipSign </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>side</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>type</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>vsign</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Reverse the sign of vector components with respect to axis side. Depending on type, one needs to symmetrize or anti-symmetrize:</p>
<ul>
<li>REFLECTIVE: <br  />
 o Vn -&gt; -Vn, Bn -&gt; -Bn, En -&gt; En <br  />
 o Vp -&gt; Vp, Bp -&gt; Bp, Ep -&gt; -Ep <br  />
 o Vt -&gt; Vt, Bt -&gt; Bt, Et -&gt; -Et</li>
<li>AXISYMMETRIC: <br  />
 o Vn -&gt; -Vn, Bn -&gt; -Bn, En -&gt; -En <br  />
 o Vp -&gt; Vp, Bp -&gt; Bp, Ep -&gt; Ep <br  />
 o Vt -&gt; -Vt, Bt -&gt; -Bt, Et -&gt; -Et</li>
<li>EQTSYMMETRIC: <br  />
 o Vn -&gt; -Vn, Bn -&gt; Bn, En -&gt; -En <br  />
 o Vp -&gt; Vp, Bp -&gt; -Bp, Ep -&gt; Ep <br  />
 o Vt -&gt; Vt, Bt -&gt; -Bt, Et -&gt; Et</li>
</ul>
<p>where (n) is the normal components, (p) and (t) are the transverse (or poloidal and toroidal for cylindrical and spherical coordinates) components.</p>
<p>If the radiation module is used, the transformation law for the radiation flux is the same as for the velocities.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">side</td><td>boundary side </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>boundary condition type </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vsign</td><td>an array of values (+1 or -1) giving the sign </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a40d460347652e7d9f5495ea10d2bae65" name="a40d460347652e7d9f5495ea10d2bae65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40d460347652e7d9f5495ea10d2bae65">&#9670;&#160;</a></span>OutflowBoundary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void OutflowBoundary </td>
          <td>(</td>
          <td class="paramtype">double ***</td>          <td class="paramname"><span class="paramname"><em>q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_r_box.html">RBox</a> *</td>          <td class="paramname"><span class="paramname"><em>box</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>side</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Impose zero-gradient boundary conditions on 'q' on the boundary side specified by 'side'. The input array 'q' must not represent the normal component of a staggered magnetic fied.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q</td><td>a 3D array requiring ghost zone filling </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">box</td><td>pointer to a <a class="el" href="struct_r_box.html">RBox</a> structure defining the extent of the boundary region </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">side</td><td>the side of the computational domain. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6280cd6ff9db6d2e28fc8503ae7fdea8" name="a6280cd6ff9db6d2e28fc8503ae7fdea8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6280cd6ff9db6d2e28fc8503ae7fdea8">&#9670;&#160;</a></span>PeriodicBoundary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PeriodicBoundary </td>
          <td>(</td>
          <td class="paramtype">double ***</td>          <td class="paramname"><span class="paramname"><em>q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_r_box.html">RBox</a> *</td>          <td class="paramname"><span class="paramname"><em>box</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>side</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Implements periodic boundary conditions in serial mode or when one processor only handle the periodic direction.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q</td><td>a 3D array requiring ghost zone filling </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">box</td><td>pointer to a <a class="el" href="struct_r_box.html">RBox</a> structure defining the extent of the boundary region </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">side</td><td>the side of the computational domain. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a80dffcc90bfaed8ac6a9a095cffb1a1f" name="a80dffcc90bfaed8ac6a9a095cffb1a1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80dffcc90bfaed8ac6a9a095cffb1a1f">&#9670;&#160;</a></span>PolarAxisBoundary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PolarAxisBoundary </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_data.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_r_box.html">RBox</a> *</td>          <td class="paramname"><span class="paramname"><em>box</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>side</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Boundary conditions on singular axis. </p>

</div>
</div>
<a id="af1f86b18467f2d476956cb0e773d5c2a" name="af1f86b18467f2d476956cb0e773d5c2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1f86b18467f2d476956cb0e773d5c2a">&#9670;&#160;</a></span>ReflectiveBoundary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ReflectiveBoundary </td>
          <td>(</td>
          <td class="paramtype">double ***</td>          <td class="paramname"><span class="paramname"><em>q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>s</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>stag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_r_box.html">RBox</a> *</td>          <td class="paramname"><span class="paramname"><em>box</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>side</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Make symmetric (s = 1) or anti-symmetric (s = -1) profiles with respect to the boundary plane specified by box-&gt;side. The sign is set by the <a class="el" href="#aa4ac8e2a2c5749634c201e8c8701d248">FlipSign()</a> function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">q</td><td>a 3D array requiring ghost zone filling </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>an integer taking only the values +1 (symmetric profile) or -1 (antisymmetric profile) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stag</td><td>an integer taking the values 0 (centered with respect to the boundary) or 1 (staggered with respect to the boundary). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">box</td><td>pointer to a <a class="el" href="struct_r_box.html">RBox</a> structure defining the extent of the boundary region </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">side</td><td>the side of the computational domain. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 18 2024 14:17:59 for PLUTO by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
