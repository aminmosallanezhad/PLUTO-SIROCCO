<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PLUTO: /Users/mignone/PLUTO/Src/Cooling/cooling_source.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PLUTO<span id="projectnumber">&#160;4.4-patch3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_413f4e031a85da0d68269c6fd2f76e1c.html">Src</a></li><li class="navelem"><a class="el" href="dir_11a6c0405144706b182e7f2165ec6850.html">Cooling</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">cooling_source.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Integrate cooling and reaction source terms.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="pluto_8h_source.html">pluto.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0fc5fcb3daa11fe09545e2637f2e3292" id="r_a0fc5fcb3daa11fe09545e2637f2e3292"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a0fc5fcb3daa11fe09545e2637f2e3292">CoolingSource</a> (const <a class="el" href="struct_data.html">Data</a> *d, double dt, <a class="el" href="structtime_step.html">timeStep</a> *Dts, <a class="el" href="struct_grid.html">Grid</a> *grid)</td></tr>
<tr class="separator:a0fc5fcb3daa11fe09545e2637f2e3292"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9e42c8ce15ae42fab409295a8402099" id="r_aa9e42c8ce15ae42fab409295a8402099"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa9e42c8ce15ae42fab409295a8402099">Numerical_Jacobian</a> (double *v, double **J)</td></tr>
<tr class="separator:aa9e42c8ce15ae42fab409295a8402099"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a984769d8707c874d6bd02a99d2944afc" id="r_a984769d8707c874d6bd02a99d2944afc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a984769d8707c874d6bd02a99d2944afc">gCooling_x1</a></td></tr>
<tr class="separator:a984769d8707c874d6bd02a99d2944afc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f0754733c9b3209a672fd9a0fb571d8" id="r_a2f0754733c9b3209a672fd9a0fb571d8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2f0754733c9b3209a672fd9a0fb571d8">gCooling_x2</a></td></tr>
<tr class="separator:a2f0754733c9b3209a672fd9a0fb571d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b6c60f6c7047de425e0400b611030df" id="r_a9b6c60f6c7047de425e0400b611030df"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9b6c60f6c7047de425e0400b611030df">gCooling_x3</a></td></tr>
<tr class="separator:a9b6c60f6c7047de425e0400b611030df"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Solve the system of ordinary differential equations describing optically thin cooling and ionization network (if any). We use an adaptive step size integration method and follow the strategy outlined in section 5.1 of Tesileanu et al. (2008) for handling stiff cells.</p>
<p>On output, a time-step estimate for the next time level is computed using the relative or absolute variation obtained during the integration of the ODE (from t(n) --&gt; t(n+1)) <br  />
      </p><p class="formulaDsp">
<picture><source srcset="form_10_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
   \Delta t_c = \min_{ijk}\left[\frac{\Delta t^n M_R}{\epsilon}\right]
   \,\quad\rm{where}\quad
   \epsilon = \max\left(\left|\frac{p^{n+1}}{p^n} - 1\right|,\,
              |X^{n+1}-X^n|\right)
\]" src="form_10.png"/></picture>
</p>
<p> where <picture><source srcset="form_11_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ M_R $" src="form_11.png"/></picture> is the maximum cooling rate (defined by the global variable <br  />
 <a class="el" href="globals_8h.html#a2c0aa773cc6edda442f387911970f356">g_maxCoolingRate</a>) and X are the chemical species.</p>
<p><b>References</b> </p><ul>
<li>"Simulating radiative astrophysical flows with the PLUTO code:
      a non-equilibrium, multi-species cooling function" <br  />
 Tesileanu, Mignone and Massaglia, A&amp;A (2008) 488, 429</li>
</ul>
<dl class="section author"><dt>Authors</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'and'+'re'+'a.m'+'ig'+'non'+'e@'+'uni'+'to'+'.it'; return false;">andre<span class="obfuscator">.nosp@m.</span>a.mi<span class="obfuscator">.nosp@m.</span>gnone<span class="obfuscator">.nosp@m.</span>@uni<span class="obfuscator">.nosp@m.</span>to.it</a>)<br  />
 O. Tesileanu B. Vaidya </dd></dl>
<dl class="section date"><dt>Date</dt><dd>April 09, 2019 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a0fc5fcb3daa11fe09545e2637f2e3292" name="a0fc5fcb3daa11fe09545e2637f2e3292"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fc5fcb3daa11fe09545e2637f2e3292">&#9670;&#160;</a></span>CoolingSource()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CoolingSource </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_data.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtime_step.html">timeStep</a> *</td>          <td class="paramname"><span class="paramname"><em>Dts</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *</td>          <td class="paramname"><span class="paramname"><em>grid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Integrate cooling and reaction source terms.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">d</td><td>pointer to <a class="el" href="struct_data.html">Data</a> structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>the time step to be taken </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Dts</td><td>pointer to the Time_Step structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>pointer to an array of <a class="el" href="struct_grid.html">Grid</a> structures </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa9e42c8ce15ae42fab409295a8402099" name="aa9e42c8ce15ae42fab409295a8402099"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9e42c8ce15ae42fab409295a8402099">&#9670;&#160;</a></span>Numerical_Jacobian()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Numerical_Jacobian </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **</td>          <td class="paramname"><span class="paramname"><em>J</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute Jacobian matrix numerically and get eigenvector and eigenvalue decomposition</p>
<p>The purpose of this function is to detect stiffness.</p>
<p>Note: This function is EXTREMELY time consuming. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a984769d8707c874d6bd02a99d2944afc" name="a984769d8707c874d6bd02a99d2944afc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a984769d8707c874d6bd02a99d2944afc">&#9670;&#160;</a></span>gCooling_x1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double gCooling_x1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2f0754733c9b3209a672fd9a0fb571d8" name="a2f0754733c9b3209a672fd9a0fb571d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f0754733c9b3209a672fd9a0fb571d8">&#9670;&#160;</a></span>gCooling_x2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double gCooling_x2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9b6c60f6c7047de425e0400b611030df" name="a9b6c60f6c7047de425e0400b611030df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b6c60f6c7047de425e0400b611030df">&#9670;&#160;</a></span>gCooling_x3</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double gCooling_x3</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 18 2024 14:17:59 for PLUTO by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
