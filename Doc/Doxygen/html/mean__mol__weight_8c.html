<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PLUTO: /Users/mignone/PLUTO/Src/mean_mol_weight.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PLUTO<span id="projectnumber">&#160;4.4-patch3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_413f4e031a85da0d68269c6fd2f76e1c.html">Src</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">mean_mol_weight.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Compute the mean molecular weight.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="pluto_8h_source.html">pluto.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="cooling__defs_8h_source.html">cooling_defs.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a29988943ac39ad7160dcd08944a6b83b" id="r_a29988943ac39ad7160dcd08944a6b83b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a29988943ac39ad7160dcd08944a6b83b">MeanMolecularWeight</a> (double *v)</td></tr>
<tr class="separator:a29988943ac39ad7160dcd08944a6b83b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><br  />
 </p>
<p>Compute and return the mean molecular weight as a function of the gas composition under non-equilibrium conditions. The mean molecular weight is usually needed to compute the temperature or mass density from the particle number density:     </p><p class="formulaDsp">
<picture><source srcset="form_110_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  T = \frac{p}{n_{\rm tot}k_B} = \frac{p}{\rho}\frac{m_u\mu}{k_B}
  \,,\qquad
  \rho = \mu m_u n_{\rm tot}
\]" src="form_110.png"/></picture>
</p>
<p> where <picture><source srcset="form_111_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ m_u $" src="form_111.png"/></picture> is the atomic mass unit while <picture><source srcset="form_112_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ n_{\rm tot} $" src="form_112.png"/></picture> is the number density of all particles. The Mean molecular weight is defined as the average mass of a particle of gas in terms of the atomic mass unit and it is expressed by the weighted sum of the mass of particles in atomic mass unit divided by total number of particles (see book by Ryan &amp; Norton [Eq. 1.7])   </p><p class="formulaDsp">
<picture><source srcset="form_113_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[ 
  \mu = \frac{\DS\sum_k N_k \frac{m_k}{m_u}}{\DS\sum_k N_k}
\]" src="form_113.png"/></picture>
</p>
<p> where</p><ul>
<li><picture><source srcset="form_114_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ N_k $" src="form_114.png"/></picture> is the number of particles in the gas of element k and it can be related to mass fraction <picture><source srcset="form_115_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$X_k$" src="form_115.png"/></picture> as <picture><source srcset="form_116_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\DS \frac{N_k}{V} = n_k = \frac{\rho}{m_u}\frac{X_k}{A_k}$" src="form_116.png"/></picture>, where <picture><source srcset="form_117_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$A_k$" src="form_117.png"/></picture> is the atomic mass number.</li>
<li><picture><source srcset="form_118_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ m_k $" src="form_118.png"/></picture> is the mass of each particle of element k.</li>
</ul>
<p><b>H2_COOL:</b> to compute <picture><source srcset="form_119_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\mu$" src="form_119.png"/></picture> we proceed as follows:</p><ol type="1">
<li>using standard solar composition <picture><source srcset="form_120_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ X_{\odot},\, Y_{\odot},\, Z_{\odot}$" src="form_120.png"/></picture> we derive     <p class="formulaDsp">
<picture><source srcset="form_121_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
     \frac{N_{He}}{N_H} = \frac{Y_{\odot}}{A_{He}}\frac{A_H}{X_\odot}
     ,\,\qquad
     \frac{N_Z}{N_H} = \frac{Z_{\odot}}{A_{Z}}\frac{A_H}{X_\odot}
   \]" src="form_121.png"/></picture>
</p>
</li>
<li>The weighted sum of the mass of particles in the numerator of <picture><source srcset="form_119_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\mu$" src="form_119.png"/></picture> is given by     <p class="formulaDsp">
<picture><source srcset="form_122_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
     \sum_k N_k \frac{m_k}{m_u} =   N_H   \frac{m_H}{m_u}
                                  + N_{He}\frac{m_{He}}{m_u}
                                  + N_Z   \frac{m_Z}{m_u}
   \]" src="form_122.png"/></picture>
</p>
 Note that since mass of electron is negligible, so is its contribution to the previous summation.</li>
<li>For the denominator we have    <p class="formulaDsp">
<picture><source srcset="form_123_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
     \sum_k N_k = N_{HI} + N_{HII} + N_{H2} + N_e + N_{He} + N_Z
                 + \frac{A_ZN_Z}{2}
   \]" src="form_123.png"/></picture>
</p>
 where two sources of electrons considered here: <picture><source srcset="form_124_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ N_e $" src="form_124.png"/></picture> electrons corresponding to <picture><source srcset="form_125_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ N_{HII} $" src="form_125.png"/></picture> protons due to ionization of hydrogen and <picture><source srcset="form_126_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ A_ZN_Z/2 $" src="form_126.png"/></picture> number of electrons due to metals. Note that now the electrons contribute to the total number of particles and cannot be neglected.</li>
<li>Next define the total number of hydrogen, <picture><source srcset="form_127_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ N_H = N_{HI} + N_{HII} + 2N_{H2} $" src="form_127.png"/></picture> as the sum of number of atomic hydrogen (HI), ionized hydrogen (HII, or protons) and twice the number of molecular hydrogen (H2) and the corresponding number fractions:     <p class="formulaDsp">
<picture><source srcset="form_128_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
      f_{HI}  = \frac{N_{HI}}{N_H},\quad
      f_{HII} = \frac{N_{HII}}{N_H},\quad
      f_{H2}  = \frac{N_{H2}}{N_H},\quad
   \]" src="form_128.png"/></picture>
</p>
 so that <picture><source srcset="form_129_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ f_{HI} + 2f_{H2} + f_{HII} = 1 $" src="form_129.png"/></picture>.</li>
</ol>
<p>Putting it all together:    </p><p class="formulaDsp">
<picture><source srcset="form_130_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
   \mu = \frac{A_H + A_{He}f_{He} + A_Zf_Z}
              {f_{HI} + f_{H2} + 2f_{HII} + f_{He} + f_Z + A_Z f_Z/2}
\]" src="form_130.png"/></picture>
</p>
<p> where <br  />
</p><ul>
<li><picture><source srcset="form_131_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$A_{He}, A_Z $" src="form_131.png"/></picture> are atomic mass numbers of helium and metals respectively.</li>
<li><picture><source srcset="form_132_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$f_{He} = N_{He}/N_H$" src="form_132.png"/></picture> is the fixed number fraction of helium with respect to hydrogen;</li>
<li><picture><source srcset="form_133_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$f_Z = N_Z/N_H$" src="form_133.png"/></picture> is the fixed number fraction of metals with respect to hydrogen.</li>
</ul>
<p><b>MINEq:</b> please see Eq. [12] of Tesileanu (2008)</p>
<p><b>SNEq:</b> the derivation is similar to H2_COOL with <picture><source srcset="form_134_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ f_{H2} = 0$" src="form_134.png"/></picture> yielding    </p><p class="formulaDsp">
<picture><source srcset="form_135_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
      \mu = \frac{A_H + A_{He}f_{He} + A_Zf_Z}
                 {2 - f_{HI} + f_{He} + 2f_Z}
   \]" src="form_135.png"/></picture>
</p>
<p> where one electron from metals is assumed.</p>
<p><b>No</b> <b>Chemistry:</b> in case where chemical reaction are not incuded, the mean molecular weight is computed from the mass fractions assuming a fully ionized gas:   </p><p class="formulaDsp">
<picture><source srcset="form_136_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
      \mu = \frac{A_H + A_{He}f_{He} + A_Zf_Z}{2  + 3f_{He} + f_Z(1 + A_Z/2)}
   \]" src="form_136.png"/></picture>
</p>
<p><b>References</b> </p><ul>
<li>"Stellar Evolution and Nucleosynthesis" Sean G. Ryan and Andrew J. Norton. The University of Chicago Press</li>
<li>"Simulating radiative astrophysical flows with the PLUTO code:
      a non-equilibrium, multi-species cooling function", Tesileanu, Mignone &amp; Massaglia, A&amp;A (2008) 488, 429</li>
</ul>
<dl class="section author"><dt>Authors</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'and'+'re'+'a.m'+'ig'+'non'+'e@'+'uni'+'to'+'.it'; return false;">andre<span class="obfuscator">.nosp@m.</span>a.mi<span class="obfuscator">.nosp@m.</span>gnone<span class="obfuscator">.nosp@m.</span>@uni<span class="obfuscator">.nosp@m.</span>to.it</a>)<br  />
 O. Tesileanu B. Vaidya <br  />
</dd></dl>
<dl class="section date"><dt>Date</dt><dd>Jun 02, 2021 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a29988943ac39ad7160dcd08944a6b83b" name="a29988943ac39ad7160dcd08944a6b83b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29988943ac39ad7160dcd08944a6b83b">&#9670;&#160;</a></span>MeanMolecularWeight()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double MeanMolecularWeight </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>v</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return the mean molecular weight.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>array of primitive variables (including ions) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 18 2024 14:17:59 for PLUTO by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
