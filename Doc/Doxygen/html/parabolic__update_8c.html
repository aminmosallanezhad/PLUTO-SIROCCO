<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PLUTO: /Users/mignone/PLUTO/Src/parabolic_update.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PLUTO<span id="projectnumber">&#160;4.4-patch3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_413f4e031a85da0d68269c6fd2f76e1c.html">Src</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">parabolic_update.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Compute right hand side from parabolic (diffusion) terms.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="pluto_8h_source.html">pluto.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:af82bd7ec45d35820df88615c2eeb716e" id="r_af82bd7ec45d35820df88615c2eeb716e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af82bd7ec45d35820df88615c2eeb716e">MAX_OP</a>&#160;&#160;&#160;8   /* Maximum number of diffusion operators */</td></tr>
<tr class="separator:af82bd7ec45d35820df88615c2eeb716e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a13dac3af6eb39c7c54563f2d19dc81e3" id="r_a13dac3af6eb39c7c54563f2d19dc81e3"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a13dac3af6eb39c7c54563f2d19dc81e3">PARABOLIC_OPERATORS</a> { <br />
&#160;&#160;<a class="el" href="#a13dac3af6eb39c7c54563f2d19dc81e3a79af9d9058b67f02e8b5080cde1f76c6">AMB_DIFF_OP</a>
, <a class="el" href="#a13dac3af6eb39c7c54563f2d19dc81e3a7448dc2ff1fb88692ebdf86effa24a2c">HALL_OP</a>
, <a class="el" href="#a13dac3af6eb39c7c54563f2d19dc81e3ab5427cbd7760eb61c75837ca52ad2599">RES_OP</a>
, <a class="el" href="#a13dac3af6eb39c7c54563f2d19dc81e3ad45b2d73ec543ed5d4f73e65d7475320">TC_OP</a> = RES_OP+3
, <br />
&#160;&#160;<a class="el" href="#a13dac3af6eb39c7c54563f2d19dc81e3ad39504bc8841cfa4701a374339d3efbc">VISC_OP</a>
<br />
 }</td></tr>
<tr class="separator:a13dac3af6eb39c7c54563f2d19dc81e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac2ee01ca2562ef042f459a017ad32e9d" id="r_ac2ee01ca2562ef042f459a017ad32e9d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac2ee01ca2562ef042f459a017ad32e9d">ParabolicUpdate</a> (const <a class="el" href="struct_data.html">Data</a> *d, <a class="el" href="pluto_8h.html#a8687756c20ea6b5b5987615b0ce41bd2">Data_Arr</a> dU, <a class="el" href="struct_r_box.html">RBox</a> *domBox, double **aflux, double dt, <a class="el" href="structtime_step.html">timeStep</a> *Dts, <a class="el" href="struct_grid.html">Grid</a> *grid)</td></tr>
<tr class="separator:ac2ee01ca2562ef042f459a017ad32e9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefbc26d62209abbbb901c7e763517192" id="r_aefbc26d62209abbbb901c7e763517192"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aefbc26d62209abbbb901c7e763517192">ParabolicRHS</a> (const <a class="el" href="struct_data.html">Data</a> *d, <a class="el" href="pluto_8h.html#a8687756c20ea6b5b5987615b0ce41bd2">Data_Arr</a> dU, <a class="el" href="struct_r_box.html">RBox</a> *domBox, double **aflux, int timeStepping, double dt, <a class="el" href="struct_grid.html">Grid</a> *grid)</td></tr>
<tr class="separator:aefbc26d62209abbbb901c7e763517192"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><br  />
 </p>
<p>The <a class="el" href="#ac2ee01ca2562ef042f459a017ad32e9d">ParabolicUpdate()</a> function computes the right hand side of conservative variables using contributions coming from diffusion operators only. It is called by EXPLICIT methods only immediately after the hyerbolic rhs has been computed. Note that this is <em>not</em> an operator split formalism since contributions are added as the same time level:       </p><p class="formulaDsp">
<picture><source srcset="form_216_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  \begin{array}{llc}
    (1)\quad &amp; \vec{R}^{n} &amp;  =  - \Delta t\nabla\cdot\vec{F}_h^n
    \\ \noalign{\medskip}
    (2)\quad &amp; \vec{R}^{n} &amp; +=  + \Delta t\nabla\cdot\vec{F}_p^n
  \end{array}
\]" src="form_216.png"/></picture>
</p>
<p> Step (2) is the one performed by <a class="el" href="#ac2ee01ca2562ef042f459a017ad32e9d">ParabolicUpdate()</a>. By convention, parabolic fluxes are written with the plus sign when they are on the right hand side.</p>
<p>The <a class="el" href="#aefbc26d62209abbbb901c7e763517192">ParabolicRHS()</a> function does the actual computation of the right hand side, in divergence form, of the parabolic (diffusion) operators only:   </p><p class="formulaDsp">
<picture><source srcset="form_217_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  \pd{U}{t} = \nabla\cdot\Big(D\nabla U\Big) + S
\]" src="form_217.png"/></picture>
</p>
<p> Here <code>U</code> is a generic cell-centered quantity (like momentum, magnetic field or total energy) and <picture><source srcset="form_218_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\vec{F} = D\nabla U$" src="form_218.png"/></picture> is the corresponding flux and <code>S</code> is the source terms (including geometrical source terms). Contributions may simultaneously come from ambipolar diffusion, resistivity, thermal conduction and viscosity computed, respectively, by the functions AD_Flux(), <a class="el" href="res__flux_8c.html#aef1a202b25a9d576a7c18b84eabaaca9">ResistiveFlux()</a>, <a class="el" href="tc_8h.html#ad8037dc7e79c320d7d73675ba32a42c6">TC_Flux()</a> and <a class="el" href="viscosity_8h.html#ace0306a93749bf1c5ae608ec710fa802">ViscousFlux()</a>.</p>
<p>For resistivity / ambipolar diffusion / Hall MHD, we use the divergence form of the induction equation when updating cell-centered magnetic fields:          </p><p class="formulaDsp">
<picture><source srcset="form_219_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  \pd{\vec{B}}{t} = - \nabla\times\vec{E} \equiv -\nabla\cdot\tens{M}
  \qquad\mathrm{where}\qquad
  \tens{M} = \left(\begin{array}{ccc}
      0    &amp;  E_z  &amp; -E_y  \\ \noalign{\medskip}
     -E_z  &amp;  0    &amp;  E_x  \\ \noalign{\medskip}
      E_y  &amp; -E_x  &amp; 0
  \end{array}\right) \qquad\mathrm{or\quad also}\qquad
  \tens{M}_{ij} = (\vec{E}\times\hvec{e}_i)\cdot\hvec{e}_j
\]" src="form_219.png"/></picture>
</p>
<p> which is valid for any electric vector while <picture><source srcset="form_220_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\tens{M}$" src="form_220.png"/></picture> is an antisymmetric tensor. Note that in curvilinear geometries, the right hand side contains source terms. In cylindrical coordinates, for instance:                    </p><p class="formulaDsp">
<picture><source srcset="form_221_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
   \begin{array}{lcl}
   (\nabla\cdot\tens{M})_r &amp;=&amp;\DS
                                 \frac{1}{r}\pd{}{r}(rM_{rr})
                               + \frac{1}{r}\pd{M_{\phi r}}{\phi}
                               +            \pd{M_{zr}}{z}
                               - \frac{M_{\phi\phi}}{r}
   \\ \noalign{\medskip}
   (\nabla\cdot\tens{M})_\phi &amp;=&amp;\DS
                                 \frac{1}{r}\pd{}{r}(rM_{r\phi})
                               + \frac{1}{r}\pd{M_{\phi\phi}}{\phi}
                               +            \pd{M_{z\phi}}{z}
                               + \frac{M_{\phi r}}{r}
   \\ \noalign{\medskip}
   (\nabla\cdot\tens{M})_z &amp;=&amp;\DS
                                 \frac{1}{r}\pd{}{r}(rM_{rz})
                               + \frac{1}{r}\pd{M_{\phi z}}{\phi}
                               +            \pd{M_{zz}}{z}
   \end{array}
\]" src="form_221.png"/></picture>
</p>
<p>This function is intended for operator split algorithms (STS, RKL) as well as explicit time stepping.</p>
<p>This function also computes the inverse diffusion time step by adding, for each diffusion equation, contributions coming from different directions:     </p><p class="formulaDsp">
<picture><source srcset="form_222_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[ \Delta t_{p}^{-1} = 
    \max\left[\frac{D_{i+\HALF} + D_{i-\HALF}}{2\Delta x^2} +
              \frac{D_{j+\HALF} + D_{j-\HALF}}{2\Delta y^2} +
              \frac{D_{k+\HALF} + D_{k-\HALF}}{2\Delta z^2}\right]
\]" src="form_222.png"/></picture>
</p>
<p> where <picture><source srcset="form_223_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\eta_{x,y,z}$" src="form_223.png"/></picture> are the diffusion coefficients available at cell interfaces in the three directions, respectively, and the maximum is taken over the local processor grid.</p>
<dl class="section date"><dt>Date</dt><dd>July 10, 2019 </dd></dl>
<dl class="section author"><dt>Authors</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'and'+'re'+'a.m'+'ig'+'non'+'e@'+'uni'+'to'+'.it'; return false;">andre<span class="obfuscator">.nosp@m.</span>a.mi<span class="obfuscator">.nosp@m.</span>gnone<span class="obfuscator">.nosp@m.</span>@uni<span class="obfuscator">.nosp@m.</span>to.it</a>)<br  />
 B. Vaidya Z. Ahmane </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="af82bd7ec45d35820df88615c2eeb716e" name="af82bd7ec45d35820df88615c2eeb716e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af82bd7ec45d35820df88615c2eeb716e">&#9670;&#160;</a></span>MAX_OP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_OP&#160;&#160;&#160;8   /* Maximum number of diffusion operators */</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a13dac3af6eb39c7c54563f2d19dc81e3" name="a13dac3af6eb39c7c54563f2d19dc81e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13dac3af6eb39c7c54563f2d19dc81e3">&#9670;&#160;</a></span>PARABOLIC_OPERATORS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="#a13dac3af6eb39c7c54563f2d19dc81e3">PARABOLIC_OPERATORS</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a13dac3af6eb39c7c54563f2d19dc81e3a79af9d9058b67f02e8b5080cde1f76c6" name="a13dac3af6eb39c7c54563f2d19dc81e3a79af9d9058b67f02e8b5080cde1f76c6"></a>AMB_DIFF_OP&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a13dac3af6eb39c7c54563f2d19dc81e3a7448dc2ff1fb88692ebdf86effa24a2c" name="a13dac3af6eb39c7c54563f2d19dc81e3a7448dc2ff1fb88692ebdf86effa24a2c"></a>HALL_OP&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a13dac3af6eb39c7c54563f2d19dc81e3ab5427cbd7760eb61c75837ca52ad2599" name="a13dac3af6eb39c7c54563f2d19dc81e3ab5427cbd7760eb61c75837ca52ad2599"></a>RES_OP&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a13dac3af6eb39c7c54563f2d19dc81e3ad45b2d73ec543ed5d4f73e65d7475320" name="a13dac3af6eb39c7c54563f2d19dc81e3ad45b2d73ec543ed5d4f73e65d7475320"></a>TC_OP&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="a13dac3af6eb39c7c54563f2d19dc81e3ad39504bc8841cfa4701a374339d3efbc" name="a13dac3af6eb39c7c54563f2d19dc81e3ad39504bc8841cfa4701a374339d3efbc"></a>VISC_OP&#160;</td><td class="fielddoc"></td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aefbc26d62209abbbb901c7e763517192" name="aefbc26d62209abbbb901c7e763517192"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefbc26d62209abbbb901c7e763517192">&#9670;&#160;</a></span>ParabolicRHS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ParabolicRHS </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_data.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pluto_8h.html#a8687756c20ea6b5b5987615b0ce41bd2">Data_Arr</a></td>          <td class="paramname"><span class="paramname"><em>dU</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_r_box.html">RBox</a> *</td>          <td class="paramname"><span class="paramname"><em>domBox</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **</td>          <td class="paramname"><span class="paramname"><em>aflux</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>timeStepping</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *</td>          <td class="paramname"><span class="paramname"><em>grid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Pointer to the PLUTO data structure. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dU</td><td>3D array containing the conservative right hand sides </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">domBox</td><td>A pointer to an <a class="el" href="struct_r_box.html">RBox</a> structure defining the zones of the domain to be updated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aflux</td><td>A 2D pointer to store fluxes (needed by Chombo) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeStepping</td><td>an integer specifying the time stepping method (= EXPLICIT / STS / RKL) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>the time step </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>pointer to <a class="el" href="struct_grid.html">Grid</a> structure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On output it returns the maximum diffusion coefficients among all dissipative term over the local processor grid. </dd></dl>

</div>
</div>
<a id="ac2ee01ca2562ef042f459a017ad32e9d" name="ac2ee01ca2562ef042f459a017ad32e9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2ee01ca2562ef042f459a017ad32e9d">&#9670;&#160;</a></span>ParabolicUpdate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ParabolicUpdate </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_data.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pluto_8h.html#a8687756c20ea6b5b5987615b0ce41bd2">Data_Arr</a></td>          <td class="paramname"><span class="paramname"><em>dU</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_r_box.html">RBox</a> *</td>          <td class="paramname"><span class="paramname"><em>domBox</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double **</td>          <td class="paramname"><span class="paramname"><em>aflux</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structtime_step.html">timeStep</a> *</td>          <td class="paramname"><span class="paramname"><em>Dts</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *</td>          <td class="paramname"><span class="paramname"><em>grid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>It is called only by explicit schemes.</p>
<dl class="section note"><dt>Note</dt><dd>When the entropy switch is enabled, the right hand side is comuted as a combination of energy, momentum and magnetic feld rhs:      <p class="formulaDsp">
<picture><source srcset="form_224_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
         \Delta\sigma = \Delta t\frac{\Gamma-1}{\rho^{\Gamma-1}}
                        \left[\Delta E - \vec{v}\cdot\Delta\vec{m}
                                       - \vec{B}\cdot\Delta{\vec{B}}
                                       \right]
      \]" src="form_224.png"/></picture>
</p>
 where <picture><source srcset="form_225_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\sigma = p/\rho^{\Gamma-1}$" src="form_225.png"/></picture> is the conserved entropy.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Pointer to the PLUTO data structure. When set to <code>NULL</code>, the right hand side is not recomputed, and the most recent computed value of rhs[] is employed (useful for CTU algorithms). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">dU</td><td>Array of conservative rhs to be updated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">domBox</td><td>A pointer to an <a class="el" href="struct_r_box.html">RBox</a> structure defining the zones of the domain to be updated </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">aflux</td><td>A 2D pointer to store fluxes (needed by Chombo) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>The time step increment </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Dts</td><td>Pointer to the <a class="el" href="structtime_step.html">timeStep</a> structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>Pointer to the grid structure </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 18 2024 14:17:59 for PLUTO by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
