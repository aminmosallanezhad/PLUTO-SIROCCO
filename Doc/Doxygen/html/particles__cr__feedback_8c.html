<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PLUTO: /Users/mignone/PLUTO/Src/Particles/particles_cr_feedback.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PLUTO<span id="projectnumber">&#160;4.4-patch3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_413f4e031a85da0d68269c6fd2f76e1c.html">Src</a></li><li class="navelem"><a class="el" href="dir_9206b596ebf640a5bddb105d741e15ea.html">Particles</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">particles_cr_feedback.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>File containing functions for feedback from CR to the fluid.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="pluto_8h_source.html">pluto.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:af189615961950d3b67a289f2fede568c" id="r_af189615961950d3b67a289f2fede568c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af189615961950d3b67a289f2fede568c">CROSS_PRODUCT_X1</a>(a,  b)&#160;&#160;&#160;( (a)[<a class="el" href="pluto_8h.html#aa38792ac21723af26ced6bae979c71c0">JDIR</a>]*(b)[<a class="el" href="pluto_8h.html#aaac5becd3ee649671537b7a5e0843a7b">KDIR</a>] - (a)[<a class="el" href="pluto_8h.html#aaac5becd3ee649671537b7a5e0843a7b">KDIR</a>]*(a)[<a class="el" href="pluto_8h.html#aa38792ac21723af26ced6bae979c71c0">JDIR</a>] )</td></tr>
<tr class="separator:af189615961950d3b67a289f2fede568c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abca1034d271cb6aebb6aa388beaf83fa" id="r_abca1034d271cb6aebb6aa388beaf83fa"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abca1034d271cb6aebb6aa388beaf83fa">CROSS_PRODUCT_X2</a>(a,  b)&#160;&#160;&#160;( (a)[<a class="el" href="pluto_8h.html#aaac5becd3ee649671537b7a5e0843a7b">KDIR</a>]*(b)[<a class="el" href="pluto_8h.html#acd93c6a80d994de60a17307da200e4cc">IDIR</a>] - (a)[<a class="el" href="pluto_8h.html#acd93c6a80d994de60a17307da200e4cc">IDIR</a>]*(a)[<a class="el" href="pluto_8h.html#aaac5becd3ee649671537b7a5e0843a7b">KDIR</a>] )</td></tr>
<tr class="separator:abca1034d271cb6aebb6aa388beaf83fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8b59ba1f8e15424fb30050fb944484a" id="r_ae8b59ba1f8e15424fb30050fb944484a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae8b59ba1f8e15424fb30050fb944484a">CROSS_PRODUCT_X3</a>(a,  b)&#160;&#160;&#160;( (a)[<a class="el" href="pluto_8h.html#acd93c6a80d994de60a17307da200e4cc">IDIR</a>]*(b)[<a class="el" href="pluto_8h.html#aa38792ac21723af26ced6bae979c71c0">JDIR</a>] - (a)[<a class="el" href="pluto_8h.html#aa38792ac21723af26ced6bae979c71c0">JDIR</a>]*(a)[<a class="el" href="pluto_8h.html#acd93c6a80d994de60a17307da200e4cc">IDIR</a>] )</td></tr>
<tr class="separator:ae8b59ba1f8e15424fb30050fb944484a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab2ec9790fd367bce9b2ad33bbd9c8692" id="r_ab2ec9790fd367bce9b2ad33bbd9c8692"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab2ec9790fd367bce9b2ad33bbd9c8692">Particles_CR_ConservativeFeedback</a> (<a class="el" href="pluto_8h.html#a8687756c20ea6b5b5987615b0ce41bd2">Data_Arr</a> U, <a class="el" href="pluto_8h.html#a8687756c20ea6b5b5987615b0ce41bd2">Data_Arr</a> Fcr, double dt, <a class="el" href="struct_r_box.html">RBox</a> *box)</td></tr>
<tr class="separator:ab2ec9790fd367bce9b2ad33bbd9c8692"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f1ca28591574203fd95e3d854cb1576" id="r_a8f1ca28591574203fd95e3d854cb1576"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8f1ca28591574203fd95e3d854cb1576">Particles_CR_Flux</a> (const <a class="el" href="struct_state.html">State</a> *state, int beg, int end)</td></tr>
<tr class="separator:a8f1ca28591574203fd95e3d854cb1576"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18e30e56cb437719172271e7f932c2dd" id="r_a18e30e56cb437719172271e7f932c2dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a18e30e56cb437719172271e7f932c2dd">Particles_CR_States1DCopy</a> (const <a class="el" href="struct_data.html">Data</a> *d, const <a class="el" href="struct_sweep.html">Sweep</a> *sweep, int beg, int end)</td></tr>
<tr class="separator:a18e30e56cb437719172271e7f932c2dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cc104b5fb39303b6b3bf202946aabb4" id="r_a4cc104b5fb39303b6b3bf202946aabb4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a4cc104b5fb39303b6b3bf202946aabb4">Particles_CR_StatesSource</a> (const <a class="el" href="struct_sweep.html">Sweep</a> *sweep, double dt, int beg, int end, <a class="el" href="struct_grid.html">Grid</a> *grid)</td></tr>
<tr class="separator:a4cc104b5fb39303b6b3bf202946aabb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><br  />
 </p>
<dl class="section author"><dt>Authors</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'and'+'re'+'a.m'+'ig'+'non'+'e@'+'uni'+'to'+'.it'; return false;">andre<span class="obfuscator">.nosp@m.</span>a.mi<span class="obfuscator">.nosp@m.</span>gnone<span class="obfuscator">.nosp@m.</span>@uni<span class="obfuscator">.nosp@m.</span>to.it</a>)<br  />
 <b>References</b> <ul>
<li>"MAGNETOHYDRODYNAMIC-PARTICLE-IN-CELL METHOD FOR COUPLING COSMIC RAYS 
     WITH A THERMAL PLASMA: APPLICATION TO NON-RELATIVISTIC SHOCKS"<br  />
 Bai et al., ApJ (2015) 809, 55</li>
</ul>
</dd></dl>
<dl class="section date"><dt>Date</dt><dd>June 15, 2017 </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="af189615961950d3b67a289f2fede568c" name="af189615961950d3b67a289f2fede568c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af189615961950d3b67a289f2fede568c">&#9670;&#160;</a></span>CROSS_PRODUCT_X1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CROSS_PRODUCT_X1</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)&#160;&#160;&#160;( (a)[<a class="el" href="pluto_8h.html#aa38792ac21723af26ced6bae979c71c0">JDIR</a>]*(b)[<a class="el" href="pluto_8h.html#aaac5becd3ee649671537b7a5e0843a7b">KDIR</a>] - (a)[<a class="el" href="pluto_8h.html#aaac5becd3ee649671537b7a5e0843a7b">KDIR</a>]*(a)[<a class="el" href="pluto_8h.html#aa38792ac21723af26ced6bae979c71c0">JDIR</a>] )</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="abca1034d271cb6aebb6aa388beaf83fa" name="abca1034d271cb6aebb6aa388beaf83fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abca1034d271cb6aebb6aa388beaf83fa">&#9670;&#160;</a></span>CROSS_PRODUCT_X2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CROSS_PRODUCT_X2</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)&#160;&#160;&#160;( (a)[<a class="el" href="pluto_8h.html#aaac5becd3ee649671537b7a5e0843a7b">KDIR</a>]*(b)[<a class="el" href="pluto_8h.html#acd93c6a80d994de60a17307da200e4cc">IDIR</a>] - (a)[<a class="el" href="pluto_8h.html#acd93c6a80d994de60a17307da200e4cc">IDIR</a>]*(a)[<a class="el" href="pluto_8h.html#aaac5becd3ee649671537b7a5e0843a7b">KDIR</a>] )</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae8b59ba1f8e15424fb30050fb944484a" name="ae8b59ba1f8e15424fb30050fb944484a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8b59ba1f8e15424fb30050fb944484a">&#9670;&#160;</a></span>CROSS_PRODUCT_X3</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CROSS_PRODUCT_X3</td>
          <td>(</td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>a</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"></td>          <td class="paramname"><span class="paramname"><em>b</em></span>&#160;)&#160;&#160;&#160;( (a)[<a class="el" href="pluto_8h.html#acd93c6a80d994de60a17307da200e4cc">IDIR</a>]*(b)[<a class="el" href="pluto_8h.html#aa38792ac21723af26ced6bae979c71c0">JDIR</a>] - (a)[<a class="el" href="pluto_8h.html#aa38792ac21723af26ced6bae979c71c0">JDIR</a>]*(a)[<a class="el" href="pluto_8h.html#acd93c6a80d994de60a17307da200e4cc">IDIR</a>] )</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab2ec9790fd367bce9b2ad33bbd9c8692" name="ab2ec9790fd367bce9b2ad33bbd9c8692"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2ec9790fd367bce9b2ad33bbd9c8692">&#9670;&#160;</a></span>Particles_CR_ConservativeFeedback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_CR_ConservativeFeedback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pluto_8h.html#a8687756c20ea6b5b5987615b0ce41bd2">Data_Arr</a></td>          <td class="paramname"><span class="paramname"><em>U</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pluto_8h.html#a8687756c20ea6b5b5987615b0ce41bd2">Data_Arr</a></td>          <td class="paramname"><span class="paramname"><em>Fcr</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_r_box.html">RBox</a> *</td>          <td class="paramname"><span class="paramname"><em>box</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add source term to the right hand side of the conservative MHD equations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">U</td><td>An array of conserved quantities, U[k][j][i][nv] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Fcr</td><td>An array containing the CR feedback, Fcr[4][k][j][i] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>The time step increment </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">box</td><td>A pointer to a <a class="el" href="struct_r_box.html">RBox</a> structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8f1ca28591574203fd95e3d854cb1576" name="a8f1ca28591574203fd95e3d854cb1576"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f1ca28591574203fd95e3d854cb1576">&#9670;&#160;</a></span>Particles_CR_Flux()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_CR_Flux </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_state.html">State</a> *</td>          <td class="paramname"><span class="paramname"><em>state</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>beg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>end</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add CR flux contribution to MHD fluxes. On input, it requires <code>state-&gt;Fcr</code> to be already computed. On output, it returns <code>state-&gt;fluxCR</code>. </p>

</div>
</div>
<a id="a18e30e56cb437719172271e7f932c2dd" name="a18e30e56cb437719172271e7f932c2dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18e30e56cb437719172271e7f932c2dd">&#9670;&#160;</a></span>Particles_CR_States1DCopy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_CR_States1DCopy </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_data.html">Data</a> *</td>          <td class="paramname"><span class="paramname"><em>d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="struct_sweep.html">Sweep</a> *</td>          <td class="paramname"><span class="paramname"><em>sweep</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>beg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>end</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Load Fcr from 3D data into 1D state structures. This is needed later to compute the flux (Particles_CR_Flux). </p>

</div>
</div>
<a id="a4cc104b5fb39303b6b3bf202946aabb4" name="a4cc104b5fb39303b6b3bf202946aabb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cc104b5fb39303b6b3bf202946aabb4">&#9670;&#160;</a></span>Particles_CR_StatesSource()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_CR_StatesSource </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="struct_sweep.html">Sweep</a> *</td>          <td class="paramname"><span class="paramname"><em>sweep</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>dt</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>beg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>end</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *</td>          <td class="paramname"><span class="paramname"><em>grid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add CR flux-difference and source term contributions to L/R primitive states during the predictor step of CTU algorithm. Note that, although the update should be done in conservative variables, we choose to directly update primitive variables by performing, in place, a conservative-to-primitive recovery so that:                       </p><p class="formulaDsp">
<picture><source srcset="form_226_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
   \left\{\begin{array}{lcl}
     \vec{m}_\pm &amp;\leftarrow&amp; \DS
     \vec{m}_\pm - \frac{\Delta t}{2}\vec{F}_{CR}
     \\ \noalign{\medskip}
     \vec{B}_\pm &amp;\leftarrow&amp; \DS
     \vec{B}_\pm + \frac{\Delta t}{2}\nabla_x\times
                   \left(\frac{\vec{F}_{CR}}{q_g}\right)
     \\ \noalign{\medskip}
     {\cal E}_\pm &amp;\leftarrow&amp; \DS
     {\cal E}_\pm - \frac{\Delta t}{2}\nabla_x\cdot
     \left(\frac{\vec{F}_{CR}\times\vec{B}}{q_g} + \vec{F}_{CR}\cdot\vec{v}\right)
   \end{array}\right.
   \quad\Longrightarrow\quad
   \left\{\begin{array}{lcl}
     \vec{v}_1  &amp;=&amp; \vec{v}_0 + \Delta\vec{v}
     \\ \noalign{\medskip}
     \vec{B}_1  &amp;=&amp; \vec{B}_0 + \Delta\vec{B}
     \\ \noalign{\medskip}
     (\rho e)_1 &amp;=&amp; \DS (\rho e)_0 + \frac{\rho}{2}(\vec{v}_0^2 - \vec{v}_1^2)
     + \frac{1}{2}\left(\vec{B}_0^2-\vec{B}_1^2\right) + \Delta {\cal E};
   \end{array}\right.
\]" src="form_226.png"/></picture>
</p>
<p>Note that curl and divergence operators are discretized using finite differences of <code>fluxCR</code> computed in <a class="el" href="#a8f1ca28591574203fd95e3d854cb1576">Particles_CR_Flux()</a>.</p>
<p>This step is done only for the primitive Hancock / Char. Trac. schemes since these are carried out in primitive variables. This step is not needed for the conservative Hancock scheme since these terms are included during the predictor.</p>
<p>For source terms not involving derivatives, we include <em>ALL</em> of the components here since no other partcles-related source term will be added during the transverse predictors. For source terms involving derivatives, we include only the normal components since the transverse predictor will add the other components through Riemann solver. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 18 2024 14:17:59 for PLUTO by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
