<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PLUTO: /Users/mignone/PLUTO/Src/Particles/particles_lp_dsa.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PLUTO<span id="projectnumber">&#160;4.4-patch3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_413f4e031a85da0d68269c6fd2f76e1c.html">Src</a></li><li class="navelem"><a class="el" href="dir_9206b596ebf640a5bddb105d741e15ea.html">Particles</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">particles_lp_dsa.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Shock-related function for LP spectra update.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="pluto_8h_source.html">pluto.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:af391522033c6496243ac889c518ddbea" id="r_af391522033c6496243ac889c518ddbea"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#af391522033c6496243ac889c518ddbea">MU_AVG</a>&#160;&#160;&#160;0.6</td></tr>
<tr class="separator:af391522033c6496243ac889c518ddbea"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a26a4b1a00b6793332abae7e46aadf26b" id="r_a26a4b1a00b6793332abae7e46aadf26b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a26a4b1a00b6793332abae7e46aadf26b">locate_spec</a> (double *, double, int, int, int)</td></tr>
<tr class="separator:a26a4b1a00b6793332abae7e46aadf26b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3090bcda9704cb1fd3be309d2b3c65c" id="r_ab3090bcda9704cb1fd3be309d2b3c65c"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab3090bcda9704cb1fd3be309d2b3c65c">RegridSpec</a> (double *, double *, double, double, int, int)</td></tr>
<tr class="separator:ab3090bcda9704cb1fd3be309d2b3c65c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf613a6ac929f7767caece88dd8c3b78" id="r_acf613a6ac929f7767caece88dd8c3b78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acf613a6ac929f7767caece88dd8c3b78">Particles_LP_SampleShock</a> (<a class="el" href="struct_particle.html">Particle</a> *pl, <a class="el" href="structparticle_probe.html">particleProbe</a> *probe, <a class="el" href="struct_grid.html">Grid</a> *grid)</td></tr>
<tr class="separator:acf613a6ac929f7767caece88dd8c3b78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81db666d8b156bb3387cd462982b8cc8" id="r_a81db666d8b156bb3387cd462982b8cc8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a81db666d8b156bb3387cd462982b8cc8">Particles_LP_GetEmaxAtShock</a> (<a class="el" href="struct_particle.html">Particle</a> *pl, <a class="el" href="structparticle_probe.html">particleProbe</a> *probe, double AccEff, <a class="el" href="struct_grid.html">Grid</a> *grid)</td></tr>
<tr class="separator:a81db666d8b156bb3387cd462982b8cc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6e321c27bb3ae2324e0ac58bb32375b" id="r_ac6e321c27bb3ae2324e0ac58bb32375b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ac6e321c27bb3ae2324e0ac58bb32375b">Particles_LP_ComputeShockNormalSpeed</a> (<a class="el" href="struct_particle.html">Particle</a> *pl, double *nhat, double *vshk)</td></tr>
<tr class="separator:ac6e321c27bb3ae2324e0ac58bb32375b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c9e3e8bd571ac80bc84b232acc36590" id="r_a8c9e3e8bd571ac80bc84b232acc36590"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8c9e3e8bd571ac80bc84b232acc36590">Particles_LP_UpdateUpstreamSpectra</a> (<a class="el" href="struct_particle.html">Particle</a> *pl, <a class="el" href="struct_grid.html">Grid</a> *grid, double <a class="el" href="runtime__setup_8c.html#a3e58e35a6ccdfe7fa814a3d1e39f7d5b">q</a>, double eng_max, long int TotpartSHK, double TotpartE, double TotpartN)</td></tr>
<tr class="separator:a8c9e3e8bd571ac80bc84b232acc36590"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Authors</dt><dd>B. Vaidya (<a href="#" onclick="location.href='mai'+'lto:'+'bva'+'id'+'ya@'+'ii'+'ti.'+'ac'+'.in'; return false;">bvaid<span class="obfuscator">.nosp@m.</span>ya@i<span class="obfuscator">.nosp@m.</span>iti.a<span class="obfuscator">.nosp@m.</span>c.in</a>)<br  />
 A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'and'+'re'+'a.m'+'ig'+'non'+'e@'+'uni'+'to'+'.it'; return false;">andre<span class="obfuscator">.nosp@m.</span>a.mi<span class="obfuscator">.nosp@m.</span>gnone<span class="obfuscator">.nosp@m.</span>@uni<span class="obfuscator">.nosp@m.</span>to.it</a>)<br  />
 D. Mukherjee (<a href="#" onclick="location.href='mai'+'lto:'+'dip'+'an'+'jan'+'.m'+'ukh'+'er'+'jee'+'@u'+'nit'+'o.'+'it'; return false;">dipan<span class="obfuscator">.nosp@m.</span>jan.<span class="obfuscator">.nosp@m.</span>mukhe<span class="obfuscator">.nosp@m.</span>rjee<span class="obfuscator">.nosp@m.</span>@unit<span class="obfuscator">.nosp@m.</span>o.it</a>)</dd></dl>
<dl class="section date"><dt>Date</dt><dd>July 3, 2019 </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="af391522033c6496243ac889c518ddbea" name="af391522033c6496243ac889c518ddbea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af391522033c6496243ac889c518ddbea">&#9670;&#160;</a></span>MU_AVG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MU_AVG&#160;&#160;&#160;0.6</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a26a4b1a00b6793332abae7e46aadf26b" name="a26a4b1a00b6793332abae7e46aadf26b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26a4b1a00b6793332abae7e46aadf26b">&#9670;&#160;</a></span>locate_spec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int locate_spec </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>ar</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>val</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>nel</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ilg</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ihg</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Search ordered array to locate val in array (spectrum). Returns index i such that: ar[i] &lt;= val &lt; ar[i+1] If val &gt; ar[nlast-1], return i = nel If val &lt; ar[0], return i = -1</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ar</td><td>Pointer to input array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">val</td><td>Value to search </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nel</td><td>Length of array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ilg</td><td>Guess value of lower bound. Give 0 if not known. <br  />
 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ihg</td><td>Guess value of upper bound. Give nel-1 if not known. ilg, ihg if given, helps achieve faster convergence. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac6e321c27bb3ae2324e0ac58bb32375b" name="ac6e321c27bb3ae2324e0ac58bb32375b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6e321c27bb3ae2324e0ac58bb32375b">&#9670;&#160;</a></span>Particles_LP_ComputeShockNormalSpeed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_LP_ComputeShockNormalSpeed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_particle.html">Particle</a> *</td>          <td class="paramname"><span class="paramname"><em>pl</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>nhat</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>vshk</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute Shock speed and Normal Unit Vector using the Coplanarity theorem (See. Schwartz 1998 Chapter on Shocks).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pl</td><td>Pointer to the <a class="el" href="struct_particle.html">Particle</a> Structure. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nhat</td><td>1D Vector for the Shock Normal. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vshk</td><td>Shock Speed. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a81db666d8b156bb3387cd462982b8cc8" name="a81db666d8b156bb3387cd462982b8cc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81db666d8b156bb3387cd462982b8cc8">&#9670;&#160;</a></span>Particles_LP_GetEmaxAtShock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Particles_LP_GetEmaxAtShock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_particle.html">Particle</a> *</td>          <td class="paramname"><span class="paramname"><em>pl</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structparticle_probe.html">particleProbe</a> *</td>          <td class="paramname"><span class="paramname"><em>probe</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>AccEff</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *</td>          <td class="paramname"><span class="paramname"><em>grid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the maximum energy of the injected energy spectrum that needs to be updated when the macro-particle crosses the shock. See Mimica 2009 &amp; Fromm 2016.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pl</td><td>Pointer to the <a class="el" href="struct_particle.html">Particle</a> Structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">AccEff</td><td>Acceleration Efficiency depends on Free Turbulence Parameter </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Maximum energy [in code units] of the updated spectrum </dd></dl>

</div>
</div>
<a id="acf613a6ac929f7767caece88dd8c3b78" name="acf613a6ac929f7767caece88dd8c3b78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf613a6ac929f7767caece88dd8c3b78">&#9670;&#160;</a></span>Particles_LP_SampleShock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_LP_SampleShock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_particle.html">Particle</a> *</td>          <td class="paramname"><span class="paramname"><em>pl</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structparticle_probe.html">particleProbe</a> *</td>          <td class="paramname"><span class="paramname"><em>probe</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *</td>          <td class="paramname"><span class="paramname"><em>grid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute upstream and downstream fluid quantites as the particles crosses the shock. The density and velocity values are required for estimating the shock normal and shock speed and finally therefore the compression ratio.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Pointer to the data structure. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">[in/out]</td><td>pl Pointer to the <a class="el" href="struct_particle.html">Particle</a> structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">grid</td><td>Pointer to the grid structure. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8c9e3e8bd571ac80bc84b232acc36590" name="a8c9e3e8bd571ac80bc84b232acc36590"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c9e3e8bd571ac80bc84b232acc36590">&#9670;&#160;</a></span>Particles_LP_UpdateUpstreamSpectra()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Particles_LP_UpdateUpstreamSpectra </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_particle.html">Particle</a> *</td>          <td class="paramname"><span class="paramname"><em>pl</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_grid.html">Grid</a> *</td>          <td class="paramname"><span class="paramname"><em>grid</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>q</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>eng_max</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long int</td>          <td class="paramname"><span class="paramname"><em>TotpartSHK</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>TotpartE</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>TotpartN</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Updates the particle spectra as the particle pl passes through the shock. The energy grid is reset and the distribution becomes a predefined power-law. We initialize <picture><source srcset="form_238_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \chi $" src="form_238.png"/></picture> to be the volume average:               </p><p class="formulaDsp">
<picture><source srcset="form_239_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
    \chi = CE^{-p}\quad\rightarrow\quad
    \av{\chi}_i = \frac{C}{\Delta E_i}
                  \int_{E_{i-\HALF}}^{E_{i+\HALF}} E^{-p}\, dE
                        =
    \left\{\begin{array}{ll}
       \DS \frac{C}{\Delta E_i}
          \Big(E^{1-p}_{i+\HALF} - E^{1-p}_{i-\HALF}\Big)
       &amp; \qquad {\rm for} \quad p \ne 1
       \\ \noalign{\medskip}
       \DS \frac{C}{\Delta E_i}
            \log\left(\frac{E_{i+\HALF}}{E_{i-\HALF}}\right)
       &amp; \qquad {\rm for} \quad p = 1
    \end{array}\right.
\]" src="form_239.png"/></picture>
</p>
<p> The constant <picture><source srcset="form_240_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ C $" src="form_240.png"/></picture> is chosen so that the total integral is gives the number of microparticles per unit (fluid) density:      </p><p class="formulaDsp">
<picture><source srcset="form_241_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  \frac{N_{\rm micro}}{\rho} = \int_{E_{\min}}^{E_{\max}} \chi\, dE = \sum_i \Delta E_i\av{\chi}_i
    = C (E_{\max}^{1-p} - E_{\min}^{1-p})
    \quad\rightarrow\quad
    C = \frac{N_{\rm micro}}{\rho}\frac{1}{E_{\max}^{1-p} - E_{\min}^{1-p}}
\]" src="form_241.png"/></picture>
</p>
<ul>
<li>Note: spectra array: (0, nel-1), size: nel energy array : (0, nel), size: nel+1 <br  />
</li>
</ul>
<p>For locate_spec, if guess value of lower bound is ilg, guess upper bound is ilg+10 or nel, whichever is lower. Locate then searches within (ilg, ilg+10) or (ilg, nel). The choice of 10 cells is arbitrary. Smaller range gives faster convergence for locate. 10 should be sufficient for typical applications.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pl</td><td>Pointer to the <a class="el" href="struct_particle.html">Particle</a> structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">q</td><td>Electron spectral momentum index : p^{-q} </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eng_max</td><td>Maximum energy of the updated spectra.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TotpartSHK</td><td>Total number of shocked particles to be updated. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TotpartE</td><td>Total energy density of unshocked cosmic ray electrons in cell Gives energy density of existing particles. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">TotpartN</td><td>Total number density of unshocked cosmic ray electrons in cell Gives number density of existing particles. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab3090bcda9704cb1fd3be309d2b3c65c" name="ab3090bcda9704cb1fd3be309d2b3c65c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3090bcda9704cb1fd3be309d2b3c65c">&#9670;&#160;</a></span>RegridSpec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double RegridSpec </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>Ein</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>inspec</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>Eout_l</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>Eout_h</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>il</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>ih</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Re-grid an input spectrum to a new energy bin array, preserving the total norm: </p><p class="formulaDsp">
<picture><source srcset="form_242_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[ \int \chi_{\rm old} dE = \int_{\rm new} dE \]" src="form_242.png"/></picture>
</p>
<p>TODO: Present implementation equivalent to a FLAT reconstruction. Update to LINEAR or PPM if needed. To Check.</p>
<p>; Config 1: (indxh - indxl &gt;= 1) ; ; indxl indxh ;in: ------&mdash;|------&mdash;|------&mdash;|-------&mdash;|-&mdash; ;out: ---------&mdash;|-----------------&mdash;|-----------&mdash; ; pout_l pout_h </p><pre class="fragment">     Config 2: outspec[i] = inspec[il]*(pout_h - pout_l)
</pre><p> ; ; indxl <br  />
 ; indxh <br  />
 ;in: ------&mdash;|------&mdash;|------&mdash;|-------&mdash;|-&mdash; ;out: -------&mdash;|--&mdash;|---------------------------&mdash; ; pout_l pout_h ; ; Config 3: outspec[i] = inspec[nel1-1]*(pin[nel1] - pout_l) ; ; indxl <br  />
 ; indxh <br  />
 ;in: ------&mdash;| ;out: --&mdash;|----------&mdash;|&ndash; ; pout_l pout_h ; ; Config 4: outspec[i] = inspec[0]*(pout_h - pin[0]) ; ; indxl <br  />
 ; indxh <br  />
 ;in: |-------&mdash;|-&mdash; ;out: -----&mdash;|----&mdash;|----&mdash; ; pout_l pout_h </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 18 2024 14:17:59 for PLUTO by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
