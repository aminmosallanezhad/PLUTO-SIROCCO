<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PLUTO: Computation of the Right Hand Side</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PLUTO<span id="projectnumber">&#160;4.4-patch3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Computation of the Right Hand Side</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="RHS_page"></a> The right hand side is constructed by adding, in succession, 1-D <br  />
 contributions coming from different sweeps:      </p><p class="formulaDsp">
<picture><source srcset="form_42_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
   \vec{U}^{n+1}_{ijk} - \vec{U}^n_{\ivec} = 
      \vec{\cal R}^{(x_1)}_{\ivec} 
    + \vec{\cal R}^{(x_2)}_{\ivec} 
    + \vec{\cal R}^{(x_3)}_{\ivec}
 \]" src="form_42.png"/></picture>
</p>
<p> It is called once for every direction at every integration stage. The single contribution, say for the <picture><source srcset="form_43_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ x_1 $" src="form_43.png"/></picture> direction, is computed in a quasi-conservative way as       </p><p class="formulaDsp">
<picture><source srcset="form_44_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
 \vec{\cal R}^{(x_1)}_{\ivec} = -\frac{\Delta t}{\dvol_i}
 \left( {\cal A}_{i+\HALF}\vec{\cal F}_{i+\HALF} 
      - {\cal A}_{i-\HALF}\vec{\cal F}_{i-\HALF}\right)
 + \Delta t\left(\vec{\cal S}^{geo}_i + \vec{\cal S}^{body}_i 
 + \vec{\cal S}^{8w}_i\right) +\vec{\cal S}^{eglm}_i
 \]" src="form_44.png"/></picture>
</p>
<p> where the indices <picture><source srcset="form_45_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ j $" src="form_45.png"/></picture> and <picture><source srcset="form_46_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ k $" src="form_46.png"/></picture> stay fixed, <picture><source srcset="form_47_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \dvol_d $" src="form_47.png"/></picture> is the cell volume, <picture><source srcset="form_48_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \vec{\cal F}^{\cal A} $" src="form_48.png"/></picture> is the Riemann solver flux (not including pressure terms), <picture><source srcset="form_49_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ {\cal A} $" src="form_49.png"/></picture> is the interface area. The source terms  <picture><source srcset="form_50_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \vec{\cal S}^{geo}_i, \vec{\cal S}^{body}_i, 
 \vec{\cal S}^{8w}_d $" src="form_50.png"/></picture> are, respectively, the geometrical, body force, Powell's and extended GLM source terms (only for the MHD and RMHD modules). Body forces are added by calling the AddBodyForce() function.</p>
<p>The pressure term is separately discretized as a gradient operator and therefore it does not contain area factors nor it appears in the geometrical source terms. For instance, while incrementing the component of <picture><source srcset="form_51_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \vec{\cal R} $" src="form_51.png"/></picture> <br  />
 corresponding to the normal momentum <picture><source srcset="form_52_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ m_{x_1} $" src="form_52.png"/></picture> we add    </p><p class="formulaDsp">
<picture><source srcset="form_53_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  {\cal R}_{\{x_1\},\ivec}^{[m_{x_1}]} \quad -= \frac{\Delta t}{\Delta l_i}
                     \left(p_{i+\HALF} - p_{i-\HALF}\right)
 \]" src="form_53.png"/></picture>
</p>
<p> where <picture><source srcset="form_54_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \Delta l_i $" src="form_54.png"/></picture> is a line element.</p>
<p>The computation of the right hand side closely reflects the nature of the divergence or gradient operators involved in the original equations. Indeed, for <em>scalar</em> quantities such as density or energy, one simply has                    </p><p class="formulaDsp">
<picture><source srcset="form_55_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
   \pd{q}{t} + \nabla\cdot\vec{F} = 0\quad\Longrightarrow\quad
   \left\{\begin{array}{c@{+}c@{+}c@{+}c@{=}cl}
   \DS \pd{q}{t}  &amp; \DS
   \pd{F_x}{x}    &amp; \DS
   \pd{F_y}{y}    &amp; \DS
   \pd{F_z}{z}    &amp; \DS\; 0 &amp;\qquad\textrm{Cartesian}
   \\ \noalign{\medskip}
   \DS \pd{q}{t}                   &amp; \DS
   \frac{1}{r}\pd{(rF_{r})}{r}     &amp; \DS
   \frac{1}{r}\pd{F_{\phi}}{\phi}  &amp; \DS
              \pd{F_z}{z}          &amp;  \DS \;0 &amp; \qquad\textrm{Polar}
   \\ \noalign{\medskip}
   \DS \pd{q}{t}                   &amp; \DS
   \frac{1}{r^2}\pd{(r^2F_{r})}{r} &amp; \DS
   \frac{1}{rs}\pd{(s F_{\theta})}{\theta}  &amp; \DS
   \frac{1}{rs}\pd{F_\phi}{\phi}            &amp; \DS\;  0 &amp;\qquad\textrm{Spherical}
   \\ \noalign{\medskip}
   \end{array}\right.
 \]" src="form_55.png"/></picture>
</p>
<p>For <em>vector</em> quantities such as momentum and magnetic field, we exploit the symmetric or antisymmetric properties of the corresponding flux tensor.</p><ul>
<li>In Cartesian coordinates, vector components are treated as scalar quantities.</li>
<li>In polar or cylindrical coordinates, for the <em>symmetric</em> tensor <picture><source srcset="form_56_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ M_{ij} = M_{ji} $" src="form_56.png"/></picture> (as in the momentum equation), we use the angular <br  />
 momentum-conserving form:                      <p class="formulaDsp">
<picture><source srcset="form_57_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
     \pd{\vec{m}}{t} + \nabla\cdot\vec{M} = 0
       \quad \Longrightarrow \quad \left\{
     \begin{array}{c@{+}c@{+}c@{+}c@{=}c}
     \DS \pd{m_{R}}{t}                              &amp; \DS
     \frac{1}{R}\pd{(RM_{RR})}{R}        &amp; \DS
     \frac{1}{R}\pd{M_{\phi R}}{\phi} &amp; \DS
            \pd{  M_{zR}}{z}        &amp; \DS
     \frac{M_{\phi\phi}}{R}
     \\ \noalign{\medskip}
     \DS \pd{m_{\phi}}{t}                     &amp; \DS
     \frac{1}{R^2}\pd{(R^2M_{R    \phi})}{R}    &amp; \DS
     \frac{1}{R}  \pd{    M_{\phi \phi}}{\phi}  &amp; \DS
                  \pd{    M_{z    \phi}}{z}     &amp; \DS
           0
     \\ \noalign{\medskip}
     \DS \pd{m_z}{t}                   &amp; \DS
     \frac{1}{R}\pd{(R  M_{Rz})}{R}   &amp; \DS
     \frac{1}{R}\pd{M_{\phi z}}{\phi} &amp; \DS
            \pd{M_{zz}}{z}        &amp; \DS 0
     \end{array}\right.
   \]" src="form_57.png"/></picture>
</p>
 If the tensor is <em>antisymmetric</em>, <picture><source srcset="form_58_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \Omega_{ij} = -\Omega_{ji} $" src="form_58.png"/></picture> (as for the induction equation) the conservation law takes the form                    <p class="formulaDsp">
<picture><source srcset="form_59_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
     \pd{\vec{B}}{t} + \nabla\cdot\vec{\Omega} = 0
     \quad \Longrightarrow \quad \left\{
     \begin{array}{c@{+}c@{+}c@{+}c@{=}c}
     \DS \pd{B_{R}}{t}                                &amp; \DS
                                                    &amp; \DS
     \frac{1}{R}\pd{\Omega_{\phi R}}{\phi} &amp; \DS
            \pd{\Omega_{z r}}{z}       &amp; \DS\; 0
     \\ \noalign{\medskip}
     \DS \pd{B_{\phi}}{t}                            &amp; \DS
     \pd{\Omega_{R\phi}}{R}             &amp; \DS
                                            &amp; \DS
        \pd{\Omega_{z\phi}}{z}          &amp; \DS\; 0
    \\ \noalign{\medskip}
    \DS \pd{B_z}{t}                       &amp; \DS
    \frac{1}{R}\pd{(R  \Omega_{Rz})}{R}   &amp; \DS
    \frac{1}{R}\pd{\Omega_{\phi z}}{\phi} &amp; \DS
                                          &amp; \DS\;  0
     \end{array}\right.
   \]" src="form_59.png"/></picture>
</p>
 where <picture><source srcset="form_60_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \vec{\Omega} = \vec{v}\vec{B} - \vec{B}\vec{v} $" src="form_60.png"/></picture>.</li>
<li>In spherical coordinates, for a <em>symmetric</em> tensor we use                        <p class="formulaDsp">
<picture><source srcset="form_61_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
     \pd{\vec{m}}{t} + \nabla\cdot\vec{M} = 0
     \quad \Longrightarrow \quad
     \left\{
     \begin{array}{c@{+}c@{+}c@{+}c@{=}c}
       \DS \pd{m_{r}}{t}                            &amp; \DS
       \frac{1}{r^2} \pd{(r^2M_{rr})}{r}           &amp; \DS
      \frac{1}{rs}  \pd{(s  M_{\theta r})}{\theta} &amp; \DS
       \frac{1}{rs}  \pd{    M_{\phi r}}{\phi}      &amp; \DS
       \DS\frac{M_{\theta\theta} + M_{\phi\phi}}{r}
     \\ \noalign{\medskip}
     \DS \pd{m_{\theta}}{t}                        &amp; \DS
     \frac{1}{r^2}\pd{(r^2M_{r\theta})}{r}          &amp; \DS
     \frac{1}{rs} \pd{(s  M_{\theta\theta})}{\theta}  &amp; \DS
     \frac{1}{rs} \pd{    M_{\phi\theta}}{\phi}     &amp; \DS
     \frac{M_{\phi\phi}\cot\theta - M_{\theta r}}{r} 
     \\ \noalign{\medskip}
     \DS \pd{m_{\phi}}{t}                            &amp; \DS
     \frac{1}{r^3} \pd{(r^3 M_{r\phi})}{r}           &amp; \DS
     \frac{1}{rs^2}\pd{(s^2 M_{\theta\phi})}{\theta} &amp; \DS
     \frac{1}{rs}  \pd{     M_{\phi\phi}}{\phi}         &amp; \DS
        0 
     \end{array}\right.
   \]" src="form_61.png"/></picture>
</p>
 (here <picture><source srcset="form_62_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ s\equiv\sin\theta $" src="form_62.png"/></picture>) whereas, if the tensor is <em>antisymmetric</em>, <picture><source srcset="form_58_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \Omega_{ij} = -\Omega_{ji} $" src="form_58.png"/></picture>, one has</li>
</ul>
<p class="formulaDsp">
<picture><source srcset="form_63_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
    \pd{\vec{B}}{t} + \nabla\cdot\vec{\Omega} = 0
     \; \Longrightarrow \;
     \left\{\begin{array}{c@{+}c@{+}c@{+}c@{=}c}
     \DS \pd{B_{r}}{t}                                       &amp; \DS
                                                        &amp; \DS
     \frac{1}{rs}  \pd{(s \Omega_{\theta r})}{\theta} &amp; \DS
     \frac{1}{rs}  \pd{\Omega_{\phi r}}{\phi}         &amp; \DS 0
     \\ \noalign{\medskip}
     \DS \pd{B_{\theta}}{t}                      &amp; \DS
     \frac{1}{r} \pd{(r\Omega_{r\theta})}{r}      &amp; \DS
                                              &amp; \DS
     \frac{1}{rs}\pd{\Omega_{\phi\theta}}{\phi}   &amp; \DS 0
     \\ \noalign{\medskip}
     \DS \pd{B_{\phi}}{t}                          &amp; \DS
     \frac{1}{r} \pd{(r\Omega_{r\phi})}{r}          &amp; \DS
     \frac{1}{r} \pd{  \Omega_{\theta\phi}}{\theta} &amp; \DS
                                              &amp; \DS 0
     \\ \noalign{\medskip}
     \end{array}\right.
   \]" src="form_63.png"/></picture>
</p>
<p> The geometrical source terms (right hand sides in the previous equations) are evaluated by averaging interface values at the cell-centered. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 18 2024 14:18:00 for PLUTO by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
