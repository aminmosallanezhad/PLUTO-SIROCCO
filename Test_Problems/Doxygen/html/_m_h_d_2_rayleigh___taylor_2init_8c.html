<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PLUTO Test Problems: /Users/mignone/PLUTO/Test_Problems/MHD/Rayleigh_Taylor/init.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PLUTO Test Problems<span id="projectnumber">&#160;4.4-patch3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a9bf029e8facab698e5e604ecb0bd3eb.html">MHD</a></li><li class="navelem"><a class="el" href="dir_5d6b5d9d5cdec3d794667a6c8701295e.html">Rayleigh_Taylor</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">init.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Rayleigh-Taylor instability setup for hydro or MHD.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8488b38b779097d732c203983f9bb9bf" id="r_a8488b38b779097d732c203983f9bb9bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8488b38b779097d732c203983f9bb9bf">Init</a> (double *v, double x1, double x2, double x3)</td></tr>
<tr class="separator:a8488b38b779097d732c203983f9bb9bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec5cba6ad33e98822880b5199543c6e7" id="r_aec5cba6ad33e98822880b5199543c6e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aec5cba6ad33e98822880b5199543c6e7">InitDomain</a> (Data *d, Grid *grid)</td></tr>
<tr class="separator:aec5cba6ad33e98822880b5199543c6e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a840827a6d99dee4807a5efbf3c4542e3" id="r_a840827a6d99dee4807a5efbf3c4542e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a840827a6d99dee4807a5efbf3c4542e3">Analysis</a> (const Data *d, Grid *grid)</td></tr>
<tr class="separator:a840827a6d99dee4807a5efbf3c4542e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a871556305428fad692c67884bcb270bd" id="r_a871556305428fad692c67884bcb270bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a871556305428fad692c67884bcb270bd">UserDefBoundary</a> (const Data *d, RBox *box, int side, Grid *grid)</td></tr>
<tr class="separator:a871556305428fad692c67884bcb270bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Sets the initial condition for a Rayleigh-Taylor instability problem in 2 or 3 dimensions. The initial condition consists of an interface separating two fluids with different densities in hydrostatic balance:        </p><p class="formulaDsp">
<picture><source srcset="form_142_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
   \rho(y) = \left\{\begin{array}{ll}
        1    &amp; \quad{\rm for} \quad y \le 0 \\ \noalign{\medskip}
        \eta &amp; \quad{\rm for} \quad y &gt; 0
   \end{array}\right.
   \,,\qquad 
   p = p_0 + \rho y g
\]" src="form_142.png" width="308" height="47"/></picture>
</p>
<p> where <picture><source srcset="form_143_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ \eta $" src="form_143.png" width="9" height="11"/></picture> is the density of the fluid on top, <code>g</code> is the (constant) gravity pointing in the negative <code>y</code> direction. The value of the pressure at the interface (<code>p0</code>) is chosen in such a way that the sound speed in the light fluid is 1. Likewise, density is normalized to the value in the light fluid. The horizontal extent of the computational domain defines the unit length: <code>Lx=1</code>.</p>
<p>For magnetized setups, the magnetic field is purely horizontal:     </p><p class="formulaDsp">
<picture><source srcset="form_144_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
   \vec{B} =  \chi B_c\hvec{i} \,,\qquad
   B_c \equiv \sqrt{(\rho_{\rm hi} - \rho_{\rm lo})L|g|}\quad \to\quad
            \sqrt{(\eta - 1.0)|g|} 
\]" src="form_144.png" width="390" height="20"/></picture>
</p>
<p> where <code>Bc</code> is the critical magnetic field above which perturbations parallel to the magnetic field are suppressed (see Boyd &amp; Sanderson, page 99) while the value of <picture><source srcset="form_145_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\chi$" src="form_145.png" width="11" height="11"/></picture> is user-supplied (note that a factor <picture><source srcset="form_146_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ 1/\sqrt{4\pi} $" src="form_146.png" width="44" height="18"/></picture> needs to be incorporated when initializing <code>B</code> in code units).</p>
<p>The system is destabilized by perturbing the vertical velocity in proximity of the interface using a single mode (in 2D) or a Gaussian perturbation (in 3D). Aleternatively, a random perturbation can be used by setting <code>USE_RANDOM_PERTURBATION</code> to <code>YES</code> in your <code>definitions.h</code>. The runtime parameters that are read from <code>pluto.ini</code> are</p><ul>
<li><code>g_inputParam[ETA]</code>: sets the density of the upper fluid;</li>
<li><code>g_inputParam[GRAV]</code>: sets gravity (must be &lt; 0);</li>
<li><code>g_inputParam[CHI]</code>: sets the magnetic field strength in unit of the critical magnetic field <code>Bc</code>;</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Increasing the value of <code>p0</code> by a factor <code>q^2</code> is equivalent to increase gravity of the same factor and decrease velocity <br  />
 and time by a factor <code>q</code>.</dd></dl>
<p>The Rayleigh-Taylor setup has been tested with the following configurations:</p>
<center> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Conf.   </th><th class="markdownTableHeadNone">PHYSICS   </th><th class="markdownTableHeadNone">GEOMETRY   </th><th class="markdownTableHeadNone">DIM   </th><th class="markdownTableHeadNone">T. STEP.   </th><th class="markdownTableHeadNone">INTERP.   </th><th class="markdownTableHeadNone">divB   </th><th class="markdownTableHeadNone">Notes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">#01   </td><td class="markdownTableBodyNone">HD   </td><td class="markdownTableBodyNone">CARTESIAN   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">HANCOCK   </td><td class="markdownTableBodyNone">LINEAR   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">-    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">#02   </td><td class="markdownTableBodyNone">HD   </td><td class="markdownTableBodyNone">CARTESIAN   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">RK3   </td><td class="markdownTableBodyNone">MP5_FD   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">-    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">#03   </td><td class="markdownTableBodyNone">HD   </td><td class="markdownTableBodyNone">CARTESIAN   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">RK3   </td><td class="markdownTableBodyNone">PARABOLIC   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">-    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">#04   </td><td class="markdownTableBodyNone">HD   </td><td class="markdownTableBodyNone">CARTESIAN   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">RK2   </td><td class="markdownTableBodyNone">LINEAR   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">(*)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">#05   </td><td class="markdownTableBodyNone">MHD   </td><td class="markdownTableBodyNone">CARTESIAN   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">HANCOCK   </td><td class="markdownTableBodyNone">LINEAR   </td><td class="markdownTableBodyNone">CT   </td><td class="markdownTableBodyNone">-    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">#06   </td><td class="markdownTableBodyNone">MHD   </td><td class="markdownTableBodyNone">CARTESIAN   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">RK3   </td><td class="markdownTableBodyNone">MP5_FD   </td><td class="markdownTableBodyNone">GLM   </td><td class="markdownTableBodyNone">-    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">#07   </td><td class="markdownTableBodyNone">MHD   </td><td class="markdownTableBodyNone">CARTESIAN   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">RK3   </td><td class="markdownTableBodyNone">PARABOLIC   </td><td class="markdownTableBodyNone">CT   </td><td class="markdownTableBodyNone">-    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">#08   </td><td class="markdownTableBodyNone">MHD   </td><td class="markdownTableBodyNone">CARTESIAN   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">ChTr   </td><td class="markdownTableBodyNone">PARABOLIC   </td><td class="markdownTableBodyNone">GLM   </td><td class="markdownTableBodyNone">(*)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">#09   </td><td class="markdownTableBodyNone">MHD   </td><td class="markdownTableBodyNone">CARTESIAN   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">RK2   </td><td class="markdownTableBodyNone">LINEAR   </td><td class="markdownTableBodyNone">GLM   </td><td class="markdownTableBodyNone">-    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">#10   </td><td class="markdownTableBodyNone">MHD   </td><td class="markdownTableBodyNone">CARTESIAN   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">HANCOCK   </td><td class="markdownTableBodyNone">LINEAR   </td><td class="markdownTableBodyNone">GLM   </td><td class="markdownTableBodyNone">[Mig12](*)   </td></tr>
</table>
</center><p>(*) Setups for AMR-Chombo</p>
<div class="image">
<img src="mhd_rt.01.jpg" alt=""/>
<div class="caption">
Density plot at the end of configuration #01</div></div>
<dl class="section author"><dt>Author</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'and'+'re'+'a.m'+'ig'+'non'+'e@'+'uni'+'to'+'.it'; return false;">andre<span class="obfuscator">.nosp@m.</span>a.mi<span class="obfuscator">.nosp@m.</span>gnone<span class="obfuscator">.nosp@m.</span>@uni<span class="obfuscator">.nosp@m.</span>to.it</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>July 06, 2014</dd></dl>
<p><b>References:</b> <br  />
</p><ul>
<li>[Mig12]: Section 5.5 of Mignone et al., ApJS (2012) 198:7 <br  />
</li>
<li>[SG07]: Stone &amp; Gardiner, Physics of Fluids (2007), 19 </li>
</ul>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a840827a6d99dee4807a5efbf3c4542e3" name="a840827a6d99dee4807a5efbf3c4542e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a840827a6d99dee4807a5efbf3c4542e3">&#9670;&#160;</a></span>Analysis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Analysis </td>
          <td>(</td>
          <td class="paramtype">const Data *</td>          <td class="paramname"><span class="paramname"><em>d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Grid *</td>          <td class="paramname"><span class="paramname"><em>grid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8488b38b779097d732c203983f9bb9bf" name="a8488b38b779097d732c203983f9bb9bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8488b38b779097d732c203983f9bb9bf">&#9670;&#160;</a></span>Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Init </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>x1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>x2</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>x3</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aec5cba6ad33e98822880b5199543c6e7" name="aec5cba6ad33e98822880b5199543c6e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec5cba6ad33e98822880b5199543c6e7">&#9670;&#160;</a></span>InitDomain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void InitDomain </td>
          <td>(</td>
          <td class="paramtype">Data *</td>          <td class="paramname"><span class="paramname"><em>d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Grid *</td>          <td class="paramname"><span class="paramname"><em>grid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Assign initial condition by looping over the computational domain. Called after the usual <a class="el" href="_h_d_2_disk___planet_2init_8c.html#ade1d9bf89b57e557838beef854cea24e">Init()</a> function to assign initial conditions on primitive variables. Value assigned here will overwrite those prescribed during <a class="el" href="_h_d_2_disk___planet_2init_8c.html#ade1d9bf89b57e557838beef854cea24e">Init()</a>. </p>

</div>
</div>
<a id="a871556305428fad692c67884bcb270bd" name="a871556305428fad692c67884bcb270bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a871556305428fad692c67884bcb270bd">&#9670;&#160;</a></span>UserDefBoundary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UserDefBoundary </td>
          <td>(</td>
          <td class="paramtype">const Data *</td>          <td class="paramname"><span class="paramname"><em>d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">RBox *</td>          <td class="paramname"><span class="paramname"><em>box</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>side</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Grid *</td>          <td class="paramname"><span class="paramname"><em>grid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 18 2024 14:24:24 for PLUTO Test Problems by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
