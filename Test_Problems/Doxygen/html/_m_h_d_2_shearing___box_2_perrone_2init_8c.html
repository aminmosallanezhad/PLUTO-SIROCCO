<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PLUTO Test Problems: /Users/mignone/PLUTO/Test_Problems/MHD/Shearing_Box/Perrone/init.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PLUTO Test Problems<span id="projectnumber">&#160;4.4-patch3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a9bf029e8facab698e5e604ecb0bd3eb.html">MHD</a></li><li class="navelem"><a class="el" href="dir_aec06e308d9caee868e7d65e00e03139.html">Shearing_Box</a></li><li class="navelem"><a class="el" href="dir_0ff83a3157eacf360235aff6fc2da32f.html">Perrone</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">init.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Shearing Box setup.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aeb29b9897068d48c87edc4c9872f48b7" id="r_aeb29b9897068d48c87edc4c9872f48b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeb29b9897068d48c87edc4c9872f48b7">Init</a> (double *v, double x, double y, double z)</td></tr>
<tr class="separator:aeb29b9897068d48c87edc4c9872f48b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec5cba6ad33e98822880b5199543c6e7" id="r_aec5cba6ad33e98822880b5199543c6e7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aec5cba6ad33e98822880b5199543c6e7">InitDomain</a> (Data *d, Grid *grid)</td></tr>
<tr class="separator:aec5cba6ad33e98822880b5199543c6e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a840827a6d99dee4807a5efbf3c4542e3" id="r_a840827a6d99dee4807a5efbf3c4542e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a840827a6d99dee4807a5efbf3c4542e3">Analysis</a> (const Data *d, Grid *grid)</td></tr>
<tr class="separator:a840827a6d99dee4807a5efbf3c4542e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a871556305428fad692c67884bcb270bd" id="r_a871556305428fad692c67884bcb270bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a871556305428fad692c67884bcb270bd">UserDefBoundary</a> (const Data *d, RBox *box, int side, Grid *grid)</td></tr>
<tr class="separator:a871556305428fad692c67884bcb270bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa16bb96fc83453c18831f9c50aaacd1b" id="r_aa16bb96fc83453c18831f9c50aaacd1b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa16bb96fc83453c18831f9c50aaacd1b">BodyForceVector</a> (double *v, double *<a class="el" href="sedov_8c.html#ac4a3a9d5a7928c1463ddd02c789e8f24">g</a>, double x, double y, double z)</td></tr>
<tr class="separator:aa16bb96fc83453c18831f9c50aaacd1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a360b5716224c0a112a7f8068d8025ae6" id="r_a360b5716224c0a112a7f8068d8025ae6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a360b5716224c0a112a7f8068d8025ae6">BodyForcePotential</a> (double x, double y, double z)</td></tr>
<tr class="separator:a360b5716224c0a112a7f8068d8025ae6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aaf201729d90f00407ee43fc7930002" id="r_a1aaf201729d90f00407ee43fc7930002"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1aaf201729d90f00407ee43fc7930002">FARGO_SetVelocity</a> (double x1, double x2)</td></tr>
<tr class="separator:a1aaf201729d90f00407ee43fc7930002"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Set initial conditions for a shearing box model in two or three dimensions:             </p><p class="formulaDsp">
<picture><source srcset="form_202_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
  \rho = \left\{\begin{array}{ll}
    1              &amp; \quad{\rm(unstratified)} \\ \noalign{\medskip}
   \exp(-z^2/H^2) &amp; \quad{\rm(stratified)}
 \end{array}\right.
  ;\quad
  v_y = -q\Omega x\,; \quad
  p = \rho c_s^2\,; \quad
  \vec{B} = \left\{\begin{array}{ll}
   (0,0,B_z)          &amp; \quad{\rm(net\,flux)} \\ \noalign{\medskip}
   (0,0,B_z\sin 2\pi x/L_x) &amp;  \quad{\rm(no\,net\,flux)}
  \end{array}\right.
 \]" src="form_202.png" width="717" height="47"/></picture>
</p>
<p> where, by default, the angular rotation frequency is <picture><source srcset="form_188_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\Omega = 1$" src="form_188.png" width="38" height="12"/></picture> while the shear parameter is <picture><source srcset="form_189_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ q = 3/2 $" src="form_189.png" width="50" height="17"/></picture> (Keplerian rotation). In the stratified case the scale height is given by <picture><source srcset="form_190_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ H = \sqrt{2}c_s/\Omega $" src="form_190.png" width="84" height="18"/></picture>. The parameters controlling the model are the elements of the array <code>g_inputParam:</code> </p>
<ul>
<li><code>g_inputParam[BETA]</code>: sets the plasma beta (midplane), <picture><source srcset="form_191_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ B_z = \sqrt{2c_s^2/\beta} $" src="form_191.png" width="92" height="20"/></picture>;</li>
<li><code>g_inputParam[CSOUND]</code>: sets the speed of sound <picture><source srcset="form_192_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ c_s $" src="form_192.png" width="12" height="11"/></picture>.</li>
</ul>
<p>The additional constants <code>NET_FLUX</code> and <code>STRATIFICATION</code> are defined inside <code>definitions.h</code> and are used to:</p>
<ul>
<li><code>NET_FLUX</code> (<code>YES/<code>NO</code>)</code>: set the magnetic field configuration corresponding to a net magnetic flux (<code>YES</code>) or zero-net flux (<code>NO</code>);</li>
<li><code>STRATIFICATION</code> (<code>YES/<code>NO</code>)</code>: enable or disable stratified shearing box models. With stratification, density and vertical gravity are changed.</li>
</ul>
<p>The <code>Shearing_Box/</code> directory contains several configurations for different purposes:</p>
<center> <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Conf.   </th><th class="markdownTableHeadNone">DIM   </th><th class="markdownTableHeadNone">NET_FLUX   </th><th class="markdownTableHeadNone">STRAT.   </th><th class="markdownTableHeadNone">T. STEPPING   </th><th class="markdownTableHeadNone">RECONSTR.   </th><th class="markdownTableHeadNone">EOS   </th><th class="markdownTableHeadNone">Ref    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">#01   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">YES   </td><td class="markdownTableBodyNone">NO   </td><td class="markdownTableBodyNone">HANCOCK   </td><td class="markdownTableBodyNone">LINEAR   </td><td class="markdownTableBodyNone">ISOTHERMAL   </td><td class="markdownTableBodyNone">-    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">#02   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">YES   </td><td class="markdownTableBodyNone">NO   </td><td class="markdownTableBodyNone">ChTr   </td><td class="markdownTableBodyNone">PARABOLIC   </td><td class="markdownTableBodyNone">ISOTHERMAL   </td><td class="markdownTableBodyNone">-    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">#03   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">YES   </td><td class="markdownTableBodyNone">NO   </td><td class="markdownTableBodyNone">RK2   </td><td class="markdownTableBodyNone">LINEAR   </td><td class="markdownTableBodyNone">ISOTHERMAL   </td><td class="markdownTableBodyNone">[Bod08]    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">#04   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">YES   </td><td class="markdownTableBodyNone">NO   </td><td class="markdownTableBodyNone">RK2   </td><td class="markdownTableBodyNone">LINEAR   </td><td class="markdownTableBodyNone">ISOTHERMAL   </td><td class="markdownTableBodyNone">[Bod08]    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">#05   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">YES   </td><td class="markdownTableBodyNone">NO   </td><td class="markdownTableBodyNone">ChTr   </td><td class="markdownTableBodyNone">PARABOLIC   </td><td class="markdownTableBodyNone">ISOTHERMAL   </td><td class="markdownTableBodyNone">[Bod08]    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">#06   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">YES   </td><td class="markdownTableBodyNone">NO   </td><td class="markdownTableBodyNone">ChTr   </td><td class="markdownTableBodyNone">PARABOLIC   </td><td class="markdownTableBodyNone">ISOTHERMAL   </td><td class="markdownTableBodyNone">[Bod08]    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">#07   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">NO   </td><td class="markdownTableBodyNone">NO   </td><td class="markdownTableBodyNone">RK2   </td><td class="markdownTableBodyNone">LINEAR   </td><td class="markdownTableBodyNone">ISOTHERMAL   </td><td class="markdownTableBodyNone">[Mig12]    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">#08   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">NO   </td><td class="markdownTableBodyNone">NO   </td><td class="markdownTableBodyNone">RK2   </td><td class="markdownTableBodyNone">LINEAR   </td><td class="markdownTableBodyNone">ISOTHERMAL   </td><td class="markdownTableBodyNone">[Mig12] (*)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">#09   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">NO   </td><td class="markdownTableBodyNone">NO   </td><td class="markdownTableBodyNone">ChTr   </td><td class="markdownTableBodyNone">PARABOLIC   </td><td class="markdownTableBodyNone">ISOTHERMAL   </td><td class="markdownTableBodyNone">[Mig12]    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">#10   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">NO   </td><td class="markdownTableBodyNone">NO   </td><td class="markdownTableBodyNone">ChTr   </td><td class="markdownTableBodyNone">PARABOLIC   </td><td class="markdownTableBodyNone">ISOTHERMAL   </td><td class="markdownTableBodyNone">[Mig12] (*)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">#11   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">NO   </td><td class="markdownTableBodyNone">YES   </td><td class="markdownTableBodyNone">HANCOCK   </td><td class="markdownTableBodyNone">LINEAR   </td><td class="markdownTableBodyNone">ISOTHERMAL   </td><td class="markdownTableBodyNone">[Bod14]    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">#12   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">NO   </td><td class="markdownTableBodyNone">YES   </td><td class="markdownTableBodyNone">HANCOCK   </td><td class="markdownTableBodyNone">LINEAR   </td><td class="markdownTableBodyNone">IDEAL   </td><td class="markdownTableBodyNone">[Bod12] (^)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">#13   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">NO   </td><td class="markdownTableBodyNone">NO   </td><td class="markdownTableBodyNone">HANCOCK   </td><td class="markdownTableBodyNone">LINEAR   </td><td class="markdownTableBodyNone">IDEAL   </td><td class="markdownTableBodyNone">(**)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">#14   </td><td class="markdownTableBodyNone">3   </td><td class="markdownTableBodyNone">YES   </td><td class="markdownTableBodyNone">NO   </td><td class="markdownTableBodyNone">RK3   </td><td class="markdownTableBodyNone">WENO3   </td><td class="markdownTableBodyNone">IDEAL   </td><td class="markdownTableBodyNone">(**)   </td></tr>
</table>
</center><p>(*) used with FARGO to be compared to the previous configurations.</p>
<p>(**) as conf. #9 but with IDEAL eos and FARGO.</p>
<p>(^) This a simplified version of the [Bod12] setup. The actual configuration was also modifying the Riemann solver flux to guarantee zero mass flux across top and bottom boundary.</p>
<div class="image">
<img src="sb.06.png" alt=""/>
<div class="caption">
Density and magnetic field lines for configuration #06 at t = 50 using a grid resolution of 64 x 256 x 64.</div></div>
<dl class="section author"><dt>Author</dt><dd>A. Mignone (<a href="#" onclick="location.href='mai'+'lto:'+'and'+'re'+'a.m'+'ig'+'non'+'e@'+'uni'+'to'+'.it'; return false;">andre<span class="obfuscator">.nosp@m.</span>a.mi<span class="obfuscator">.nosp@m.</span>gnone<span class="obfuscator">.nosp@m.</span>@uni<span class="obfuscator">.nosp@m.</span>to.it</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>March 2, 2017</dd></dl>
<p><b>References:</b> </p><ul>
<li>[Bod08]: "Aspect ratio dependence in magnetorotational instability
               shearing box simulations" Bodo et al. A&amp;A (2008) 487, 1</li>
<li>[Mig12]: "A conservative orbital advection scheme for simulations of
               magnetized shear flows with the PLUTO code", Mignone et al., A&amp;A (2012) 545, Sec. 3.3.2</li>
<li>[Bod12]: "Magnetorotational turbulence in stratified shearing boxes
               with perfect gas equation of state and finite thermal diffusivity", Bodo et al., ApJ (2012) 761, 116</li>
<li>[Bod14]: "On the Convergence of Magnetorotational Turbulence in
               Stratified Isothermal Shearing Boxes" Bodo et al. (2014) 787 L13 </li>
</ul>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a840827a6d99dee4807a5efbf3c4542e3" name="a840827a6d99dee4807a5efbf3c4542e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a840827a6d99dee4807a5efbf3c4542e3">&#9670;&#160;</a></span>Analysis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Analysis </td>
          <td>(</td>
          <td class="paramtype">const Data *</td>          <td class="paramname"><span class="paramname"><em>d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Grid *</td>          <td class="paramname"><span class="paramname"><em>grid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute volume-integrated magnetic pressure, Maxwell and Reynolds stresses. Also kinetic energy (LMP). Save them to "averages.dat" </p>

</div>
</div>
<a id="a360b5716224c0a112a7f8068d8025ae6" name="a360b5716224c0a112a7f8068d8025ae6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a360b5716224c0a112a7f8068d8025ae6">&#9670;&#160;</a></span>BodyForcePotential()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double BodyForcePotential </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>z</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa16bb96fc83453c18831f9c50aaacd1b" name="aa16bb96fc83453c18831f9c50aaacd1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa16bb96fc83453c18831f9c50aaacd1b">&#9670;&#160;</a></span>BodyForceVector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BodyForceVector </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>g</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>z</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Include gravitational force in the shearing box module. Coriolis terms are included elsewhere.</p>
<p>Note: with FARGO, gravity in the x-direction must not be included. </p>

</div>
</div>
<a id="a1aaf201729d90f00407ee43fc7930002" name="a1aaf201729d90f00407ee43fc7930002"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1aaf201729d90f00407ee43fc7930002">&#9670;&#160;</a></span>FARGO_SetVelocity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double FARGO_SetVelocity </td>
          <td>(</td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>x1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>x2</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute the shear angular velocity to be subtracted from the HD or MHD equations. </p>

</div>
</div>
<a id="aeb29b9897068d48c87edc4c9872f48b7" name="aeb29b9897068d48c87edc4c9872f48b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb29b9897068d48c87edc4c9872f48b7">&#9670;&#160;</a></span>Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Init </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>v</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>x</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>y</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>z</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aec5cba6ad33e98822880b5199543c6e7" name="aec5cba6ad33e98822880b5199543c6e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec5cba6ad33e98822880b5199543c6e7">&#9670;&#160;</a></span>InitDomain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void InitDomain </td>
          <td>(</td>
          <td class="paramtype">Data *</td>          <td class="paramname"><span class="paramname"><em>d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Grid *</td>          <td class="paramname"><span class="paramname"><em>grid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Assign initial condition by looping over the computational domain. Called after the usual <a class="el" href="_h_d_2_disk___planet_2init_8c.html#ade1d9bf89b57e557838beef854cea24e">Init()</a> function to assign initial conditions on primitive variables. Value assigned here will overwrite those prescribed during <a class="el" href="_h_d_2_disk___planet_2init_8c.html#ade1d9bf89b57e557838beef854cea24e">Init()</a>. </p>

</div>
</div>
<a id="a871556305428fad692c67884bcb270bd" name="a871556305428fad692c67884bcb270bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a871556305428fad692c67884bcb270bd">&#9670;&#160;</a></span>UserDefBoundary()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UserDefBoundary </td>
          <td>(</td>
          <td class="paramtype">const Data *</td>          <td class="paramname"><span class="paramname"><em>d</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">RBox *</td>          <td class="paramname"><span class="paramname"><em>box</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>side</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Grid *</td>          <td class="paramname"><span class="paramname"><em>grid</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The user-defined boundary is used to impose stress-free boundary and purely vertical magnetic field at the top and bottom boundaries, as done in Bodo et al. (2012). In addition, constant temperature and hydrostatic balance are imposed. For instance, at the bottom boundary, one has:        </p><p class="formulaDsp">
<picture><source srcset="form_193_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
   \left\{\begin{array}{lcl}
    \DS  \frac{dp}{dz} &amp;=&amp; \rho g_z  \\ \noalign{\medskip}
          p            &amp;=&amp; \rho c_s^2
   \end{array}\right.
   \qquad\Longrightarrow\qquad
   \frac{p_{k+1}-p_k}{\Delta z} = \frac{p_{k} + p_{k+1}}{2c_s^2}g_z
\]" src="form_193.png" width="369" height="59"/></picture>
</p>
<p> where <picture><source srcset="form_194_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$g_z$" src="form_194.png" width="15" height="11"/></picture> is the value of gravity at the lower boundary. Solving for <picture><source srcset="form_195_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$p_k$" src="form_195.png" width="15" height="11"/></picture> at the bottom boundary where <picture><source srcset="form_196_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$k=k_b-1$" src="form_196.png" width="68" height="15"/></picture> gives:        </p><p class="formulaDsp">
<picture><source srcset="form_203_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\[
   \left\{\begin{array}{lcl}
     p_k   &amp;=&amp; \DS  p_{k+1} \frac{1-a}{1+a}  \\ \noalign{\medskip}
    \rho_k &amp;=&amp; \DS \frac{p_k}{c_s^2}
   \end{array}\right.
   \qquad\mathrm{where}\qquad
   a = \frac{\Delta z g_z}{2c_s^2} &gt; 0
\]" src="form_203.png" width="345" height="74"/></picture>
</p>
<p> where, for simplicity, we keep constant temperature in the ghost zones rather than at the boundary interface (this seems to give a more stable behavior and avoids negative densities). A similar treatment holds at the top boundary. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 18 2024 14:24:24 for PLUTO Test Problems by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
